#!set(linkName="product-archive",sonitem="
<li>"+"文档"+"</li>")

<script type="text/javascript">
    function ajaxRead(id,toName,opKey,opvalue,url,value){
        var selectCheck = "select[name="+toName+"]";
        $(selectCheck).each(function(){
            var sele = $(this);
            var s;
            $.ajax({
                type: "POST",
                url: "${TINY_CONTEXT_PATH+adminPath}"+url,
                data: $(this).attr('data'),
                dataType:"json",
                success: function(data){
                    sele.empty();
                    for(var i=0,l=data.length;i<l;i++){
                        var em = "<option value='"+data[i][opKey]+"' >"+ data[i][opvalue] +"</option>";
                        sele.append(em);

                    }

                    if(value!=null) {
                        sele.val(value).trigger("change");
                    }else {
                        sele.val(data[0][opKey]).trigger("change");
                    }


                },
                error: function(res){
                ##    alert("失败");
                }
            });


        });

    }
</script>


#import("/org/tinygroup/form/components/form.component")
#import("/org/tinygroup/icon/components/icon.component")
#import("/org/tinygroup/button/components/button_common.component")
#import("/org/tinygroup/button/components/button.component")
#macro radio1(rId rName rChecked rValue rClass rIsDisabled radioOther)
<input#if(rId) id="$!{rId}"#{end}#if(rName) name="$!{rName}"#end#if(rChecked && rChecked=="checked")
               checked#{end}#if(rValue) value="$!{rValue}"#end#if(rClass)
               class="$!{rClass}"#end#if(rIsDisabled && rIsDisabled=="disabled") disabled#end type="radio"
               onclick="${radioOther}"/>
#end
#macro labelRadio1(rId rName rValue rClass radioOther labelText)
    #@radioBox()
    <label>
        #radio1(rId=rId rName=rName rValue=rValue rClass=rClass radioOthe=radioOther)
        ${labelText}</label>
    #end
#end


#@tinyForm("thisform" TINY_CONTEXT_PATH +adminPath+"/document/product/save/updateDoc?docProduct="+cookieProductId+"&docLibId=1&docDeleted=0" "post" {"class":"test","enctype":
    "multipart/form-data"})

<div style="width:100%">
<div class="infoContent">
    <p class="titleName">创建文档</p>
    #@elementItem()
        #@colLabel()<span class="c-red">*</span>所属产品#end
        #@formControlDiv("col-4")
            #@div(divClass="col-12")
                #@Tselect2F()
                    #@Tselect2Body("docProduct" cookieProductId {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
                        <option value="0">/</option>
                        #if(cookieProductLineId)
                            #foreach(product : ProductUtils.getProductListByLine(cookieProductLineId))
                                <option value="${product?.productId}">${product?.productName}</option>
                            #end
                        #end
                    #end

                    #@Tselect2Fix()
                        <a href="${TINY_CONTEXT_PATH+adminPath}/product/addproduct/addition" class="r">增加</a>
                        <a href="${TINY_CONTEXT_PATH+adminPath}/product/allproduct/addition">全部</a>#end
                    <script type="text/javascript">
                        $("#${sid}").on("change",function(){
                            var pId = $("#${sid}  option:selected").val();
                            if(pId>0){
                            ajaxRead("${sid}","docModule","moduleId","moduleName","/document/ajax/module1?productId="+pId);
                        }
                        })
                    </script>
                #end
            #end
        #end
    #end

    #@elementItem()
        #@colLabel()<span class="c-red">*</span>所属分类#end
        #@formControlDiv("col-4")
            #@div(divClass="col-12")
                #@Tselect2F()
                    #@Tselect2Body("docModule" "" {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
                    #end
                #end
            #end
        #end
    #end

    #@elementItem()
        #@colLabel()<span class="c-red">*</span>文档类型#end
        #@skinMinimal("mt-20")
            #labelRadio1(rId="typefile" rName="docType" rChecked="checked" rValue="1" "setType(this.value);" labelText=getDict("docType","1") )
            #labelRadio1(rId="typeurl" rName="docType" rValue="2" labelText=getDict("docType","2") "setType(this.value);")
            #labelRadio1(rId="typetext" rName="docType" rValue="3" labelText=getDict("docType","3") "setType(this.value);")

        #end
        #@validateDiv("col-2")#end
    #end

    #@elementItem()
        #@colLabel()<span class="c-red">*</span>文档标题#end
        #@formControlDiv("col-4")
            #@div(divClass="col-12")
                #tinyInput("text" "docTitle" ""{"placeholder":"请输入文档标题","datatype":"*1-16","nullmsg":"文档标题不能为空！","class":"input-text"})
            #end
        #end
        #@validateDiv("col-2")#end
    #end

    #@elementItem(elementId="urlBox" eleItemClass="hidden")
        #@colLabel()<span class="c-red">*</span>文档URL#end
        #@formControlDiv("col-4")
            #@div(divClass="col-12")
                #tinyInput("text" "docUrl" ""{"placeholder":"相应的链接地址","datatype":"*","ignore":"ignore","class":"input-text"})
            #end
        #end
        #@validateDiv("col-2")#end
    #end

    #@elementItem()
        #@colLabel()关键字#end
        #@formControlDiv("col-4")
            #@div(divClass="col-12")
                #tinyInput("text" "docKeywords" ""{"placeholder":"","datatype":"","class":"input-text"})
            #end
        #end
    #end
    #@validateDiv("col-2")#end

    #@elementItem()
        #@colLabel()文档摘要#end
        #@formControlDiv("col-8")
            #@Teditor("docDigest" "docDigest" {"initialFrameHeight":"200"})#end
        #end
        #@validateDiv("col-2")#end
    #end

    #@elementItem(elementId="fileBox")
        #@colLabel()附件：#end
        #@formControlDiv("col-8")
            #include("/product/page/event/fileupload.page")
        #*					#tinyUploadInput("inputName" "" {"placeholder":"可直接输入地址，也可点击下图标进行上传"})*#
        #end
        #@validateDiv("col-2")#end
    #end
    #@elementItem(elementId="contentBox" eleItemClass="hidden")
        #@colLabel()文档正文#end
        #@formControlDiv("col-8")
            #@tinyueditor("docContent" "docContent")#end
        #end
        #@validateDiv("col-2")#end
    #end
    #@elementItem()
        <div class="col-12">
            <div class="col-5">

            </div>
            <div class="col-1">
                <button style="float: left" type="submit" id="submit" class="commitBtn">保存</button>
            </div>
            <div class="col-1">
                #@aExtendButton("btn-sm backBtn" "javascript:history.go(-1)")返回#end
            </div>
            <div class="col-5"></div>
        </div>
    #end

#end


    <script type="text/javascript">
        /* Set doc type. */
        function setType(type)
        {
            if(type == '2')
            {
                $('#urlBox').removeClass('hidden');
                $('#fileBox').addClass('hidden');
                $('#contentBox').addClass('hidden');
            }
            else if(type == '3')
            {
                $('#urlBox').addClass('hidden');
                $('#fileBox').addClass('hidden');
                $('#contentBox').removeClass('hidden');
            }
            else
            {
                $('#urlBox').addClass('hidden');
                $('#fileBox').removeClass('hidden');
                $('#contentBox').addClass('hidden');
            }
        }
    </script>

    <script type="text/javascript">
        $(function () {
            $("form[name=thisform]").Validform({
                tiptype: 2
            });
        });
    </script>