#import("/org/tinygroup/form/components/form.component")
#import("/org/tinygroup/pieCharts/components/pieCharts.component")
#import("/org/tinygroup/icon/components/icon.component")
#import("/org/tinygroup/button/components/button_common.component")
#import("/org/tinygroup/button/components/button.component")
#!set(linkName="product-demand",sonitem="<li>"+"需求"+"</li>")

<style>
    .togglebox.open .tableBoxessty{margin-left:262px}
    .togglebox.open .togglenavico{left:218px}
    .togglebox .togglenavpart{left:-260px;}
</style>

<script>
	$(document).ready(function(){
		
		$("#roadSubmit").unbind("click").bind("click",function(){
			if($("input:checked").length>0){
				$("form[name='thisform']").trigger("submit");
			}else{
				alert('请选择');
			}
		});
		
		$(".but1").unbind("click").bind("click",function(){
			 $(".navbody input[type='checkbox']").each(function(){
			 	this.checked=true
			 		
			 });//attr("checked", "checked");
			
			 		
		}); 
		
		$(".but2").unbind("click").bind("click",function(){
				
			  $(".navbody input[type='checkbox']").each(function () {
			  		this.checked=!this.checked;
			  		
			  		/*console.log(this.checked)
			  		var ischecked = $(this).is(":checked");//("checked");
			  		if(ischecked){
			  			$(this).removeAttr("checked");
			  		}else{
                   	 	$(this).attr("checked","checked");
                    }*/
                });
			
			
		}); 
	
	});
</script>

#include("/product/page/event/common.page")
#set(name="bug")
#@div()
#@tabWithInit("tab_demo" "optionsBox")
   
    #@tabBodyCol("ptop-5")
##operationbar start1
    #@div(divClass="operationbar")
    <span class="f">
		<a href="#" class="active_btn">报表</a>
	</span>
    <span class="r">
    	#@aModal("#myModal" "导出HTML" "500" "130" "btn-class" "/product/page/tabledemo/product-export-demand.pagelet")#buttonIcon(iconClass="icon-download-alt")导出#end
					
		<a href="${TINY_CONTEXT_PATH}/product/page/project/togglebox.page">#buttonIcon(iconClass="icon-goback icon-level-up icon-large icon-rotate-270")返回</a>&nbsp;
	</span>
        #div(divClass="clearfix")
    #end
##operationbar end
        #end
    #@toggleBox({"class":"open"})##展开为class:OPEN 要附加其它的属性请用MAP带入
        #@toggleLeft({"class":"aclass","style":"width:250px;height:450px;overflow:auto"})
            #@settoggleLeftTitle()请选择报表类型#end
            #@settoggleLeftBody()
            	#@tinyForm("thisform" TINY_CONTEXT_PATH+"/product/story/report" "post" {"class":"test"})
                    #@skinMinimal()
#*                    	#@Tcheckboxes("productWhiteList" product?.productWhiteList)
							#@Tcheckbox("admin")产品需求数量#end<br/>
							#@Tcheckbox("admin")模块需求数量#end<br/>
							#@Tcheckbox("admin")需求来源统计#end<br/>
							#@Tcheckbox("admin")计划进行统计#end<br/>
							#@Tcheckbox("admin")状态进行统计#end<br/>
							#@Tcheckbox("admin")所处阶段进行统计#end<br/>
							#@Tcheckbox("admin")优先级进行统计#end<br/>
							#@Tcheckbox("admin")预计工时进行统计#end<br/>
							#@Tcheckbox("admin")由谁创建来进行统计#end<br/>
							#@Tcheckbox("admin")由谁指派来进行统计#end<br/>
							#@Tcheckbox("admin")当前指派来进行统计#end<br/>
							#@Tcheckbox("admin")关闭原因来进行统计#end<br/>
							#@Tcheckbox("admin")变更次数来进行统计#end<br/>
							
						#end*#
                        #labelCheckbox(ckId="checkbox-1" ckName="chexkitem" ckValue="A_productCount" labelText="产品需求数量")
                        #labelCheckbox(ckId="checkbox-3" ckName="chexkitem" ckValue="B_moduleCount" labelText="模块需求数量")
                        #labelCheckbox(ckId="checkbox-4" ckName="chexkitem" ckValue="C_planCount" labelText="需求来源统计")
                        #labelCheckbox(ckId="checkbox-5" ckName="chexkitem" ckValue="storySource" labelText="计划进行统计")
                        #labelCheckbox(ckId="checkbox-6" ckName="chexkitem" ckValue="storyStatus" labelText="状态进行统计")
                        #labelCheckbox(ckId="checkbox-7" ckName="chexkitem" ckValue="storyStage" labelText="所处阶段进行统计")
                        #labelCheckbox(ckId="checkbox-8" ckName="chexkitem" ckValue="storyPri" labelText="优先级进行统计")
                        #labelCheckbox(ckId="checkbox-9" ckName="chexkitem" ckValue="storyEstimate" labelText="预计工时进行统计")
                        #labelCheckbox(ckId="checkbox-10" ckName="chexkitem" ckValue="storyOpenedBy" labelText="由谁创建来进行统计")
                        #labelCheckbox(ckId="checkbox-12" ckName="chexkitem" ckValue="storyAssignedTo" labelText="当前指派来进行统计")
                        #labelCheckbox(ckId="checkbox-13" ckName="chexkitem" ckValue="storyClosedReason" labelText="关闭原因来进行统计")
                        #labelCheckbox(ckId="checkbox-14" ckName="chexkitem" ckValue="storyVersion" labelText="变更次数来进行统计")
                    #end
               		 #buttonRadiusDefault(btId="but1" btClass="but1" caption="全选")
			        #buttonRadiusDefault(btId="but2" btClass="but2" caption="反选")
			        #buttonRadiusDanger(btId="roadSubmit" caption="生成报表") 
				 #end
            #end
           
        #end 
        
        #@toggleRight("tableBoxessty")
        
            #@settoggleLeftTitle()报表#end
           
            
            <table class="table table-border table-bordered" cellspacing="0">
            		
            		
            	#foreach(roadMap:map)
    					
    					#@centerAlignTr()       
	            		 #@th("text-r" "vertical-align:middle;width:20%")
	            			#@pieChart(pieChartStyle="width:600px;margin:0 auto;")
	            				 <table id='${roadMap?.key}'>
									<caption>${roadMap?.key}需求数量分布</caption>
									<thead>
										<tr>
											<th></th>
											#for(road:roadMap?.value)
												<th>${road?.name}</th>
											#end
										</tr>
									</thead>
									
									<tbody>
										<tr>
											<th></th>
											#for(road:roadMap?.value)
												<td>${road?.number}</td>
											#end
										</tr>
									</tbody>
								</table>
				
							#end
							#pieChartInit("#"+roadMap?.key "PieChart" "No of players" "Month",600,350)
	            			
	            		#end
	            		
	            		
	            		<td  style="vertical-align:middle;">
	            			#*            				产品需求数量分布*#
	            			 <table class="table table-border table-bordered" cellspacing="0">
	            			 	 #@theadCenterMenu()   #@th()分类#end        #@th()需求数#end  #@th()百分比#end #end
	            			 	 
	            			 	 #for(road:roadMap?.value)
									#@centerAlignTr()        
		            			 	 	
		            			 	 	#@td()${road?.name}#end  
		            			 	 	#@td()${road?.number}#end      
		            			 	 	#@td()${road?.percentToString}#end     
		            			 	 #end
								#end
	            			 	
	            			 	
	            			 
	            			 </table>
	            			
	
	            			
	            		</td>
	            	
	            	#end
					            				
    			#end
            		
            </table>
            

        #end
    #end

#end
#end