#import("/org/tinygroup/form/components/form.component")
#import("/org/tinygroup/bootstrapDate/components/bootstrapDate.component")
#import("/org/tinygroup/button/components/button_common.component")
#import("/org/tinygroup/button/components/button.component")
#import("/org/tinygroup/fold/components/fold.component")
#!set(linkName="product-demand",sonitem="
<li>"+"需求"+"</li>")


<script type="text/javascript">
    $(function () {
        $("form[name=thisform").Validform({
            tiptype: 2
        });
    });
</script>


<script>

    $(document).ready(function () {

        $("#subdivision").hide();
        $("#repeat").hide();

        $("select[name='storyClosedReason']").on("change", function () {
            var subdivision = $("#subdivision");
            var repeat = $("#repeat");
            if ($(this).val() == '1') {
                repeat.hide();
                subdivision.show();
            } else if ($(this).val() == '2') {
                subdivision.hide();
                repeat.show();
            } else {
                subdivision.hide();
                repeat.hide();
            }


        });

    });
</script>

#@tinyForm("thisform" TINY_CONTEXT_PATH +adminPath+"/product/story/close" "" {"class":"test"})
    #hiddenInput("","deleted","","1")
    #hiddenInput("","storyId","",story?.storyId)
<div style="width:70%;float:left" class="pageleftpart">
    <div class="infoContent">
        <p class="titleName">关闭</p>
        #@elementItem()
            #@colLabel()关闭原因：#end
            #@formControlDiv("col-3")
                #@tinySelect("storyClosedReason" story?.storyClosedReason {"class":"input-text","rel":"22"})
                    #foreach(s:getDict("proCloseReason"))
                        <option value="${s?.value}">${s?.text}</option>
                    #end

                #end
            #end
            #@validateDiv("col-3")#end
        #end
        #@elementItem("subdivision")
            #@colLabel()<span class="c-red">*</span>细分需求：#end
            #@formControlDiv("col-3")
                #tinyInput("text" "storyChildStories" "" {"datatype":"","nullmsg":"细分需求不能为空！","class":"input-text"})
            #end
            #@validateDiv("col-2")#end
        #end
        #@elementItem("repeat")
            #@colLabel()<span class="c-red">*</span>重复需求：#end
            #@formControlDiv("col-3")
                #tinyInput("text" "storyDuplicateStory" ""{"datatype":"","nullmsg":"重复需求不能为空！","class":"input-text"})
            #end
            #@validateDiv("col-2")#end
        #end

        #@elementItem()
            #@colLabel()备注：#end
            #@formControlDiv("col-8")
                #@Teditor("actionComment" "actionComment" {"initialFrameHeight":"200" })#end
            #end
        #end
    </div>

    #@elementItem()
        <div class="col-12">
            <div class="col-5">

            </div>
            <div class="col-1">
                <button style="float: left" type="submit" id="submit" class="commitBtn">保存</button>
            </div>
            <div class="col-1">
                #@aExtendButton("btn-sm backBtn" "javascript:history.go(-1)")返回#end
            </div>
            <div class="col-5"></div>
        </div>
    #end

    <br>
</div>
#end


<div style="width:30%;float:right">
    #history(adminPath+"/system/action/ajax/history?actionObjectType=Story&actionObjectId="+story?.storyId)
</div>