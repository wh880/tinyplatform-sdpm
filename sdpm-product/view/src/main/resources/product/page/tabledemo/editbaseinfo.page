#@div(divClass="infoContent")
<p class="titleName">基本信息</p>

<ul>
<li>
    #@elementItem()
        #@colLabel()产品：#end
        #@formControlDiv("col-8")
            #@TzTreeSelect(
                "productId" cookieProductId {"class":"input-text","datatype":"*","nullmsg":"所属产品不能为空！",
                "data-URL":call("link",adminPath+"/productLine/userProductTree")})
                <script>
                    $(function(){
                        var mUrl =  $("#modelA").attr("href");
                        $("#${sid}").on("setValue",function(o,treeNode){
                            var pId = treeNode.id;
                            if (pId > 0) {
                                ajaxRead("${sid}", "moduleId", "moduleId", "moduleName", "/quality/bug/ajax/module?moduleRoot=" + pId,"${story?.productId}","module");
                                ajaxRead("${sid}", "planId", "planId", "planName", "/product/plan/planList?productId=" + pId,"${story?.planId}","plan");
                                $("#modelA").attr("href",mUrl+pId);
                                $("input[name=storyTitle]").blur();
                            }
                        });
                    });
                </script>
                <span><a href="${TINY_CONTEXT_PATH +adminPath}/product/addproduct/addition "
                         class="r ">添加</a><a
                        href=" ${TINY_CONTEXT_PATH +adminPath}/product/allproduct/addition">全部</a></span>
            #end

    #end
    #@validateDiv("col-2")#end
#end
</li>

    <li>
        #@elementItem()
            #@colLabel()所属模块：#end
            #@formControlDiv("col-8")
                #@Tselect2F()
                    #@Tselect2Body("moduleId" story?.moduleId {"class":"input-text select2"})
                    #end
                    #@Tselect2Fix()#@aModal("#myModal" "添加模块" "500" "300" "btn-class" adminPath+"/product/addModule?pId=" "modelA")
                        增加#end
                    #end
                #end
            #end
            #@validateDiv("col-2")#end
        #end
    </li>
    <li>
        #@elementItem()
            #@colLabel()所属计划：#end
            #@formControlDiv("col-8")
                #@Tselect2F()
                    #@Tselect2Body("planId" story?.planId {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项

                    #end

                    #@Tselect2Fix()
                        #@hasMenu("product-plan-add")
                            <a href="${TINY_CONTEXT_PATH +adminPath}/product/plan/addplan"
                               class="r ">增加</a>
                        #end
                    #end
                #end
            #end
            #@validateDiv("col-2")#end
        #end
    </li>
    <li>
        #@elementItem()
            #@colLabel()来源：#end
            #@formControlDiv("col-8")
                #@tinySelect("storySource" story?.storySource {"class":"input-text ","rel":"22"})
                    #foreach(source:getDict("storySource"))
                        <option value="${source?.value}" #if(story?.storySource==source?.value)selected#end> ${source
                            ?.text}
                        </option>
                    #end
                #end
            #end
            #@validateDiv("col-2")#end
        #end
    </li>

    <li>
        #@elementItem()
            #@colLabel()当前状态：#end
            ${getDict("storyStatus",story?.storyStatus)}
        #end
    </li>

    <li>
        #@elementItem()
            #@colLabel()优先级：#end
            #@formControlDiv("col-8")
                #@tinySelect(
                    "storyPri" story?.storyPri {"class":"input-text ","rel":"22"
                })
                    #foreach(source:getDict("storyPri"))
                        <option value="${source?.value}"> ${source?.text}</option>
                    #end

                #end
            #end
            #@validateDiv("col-2")#end
        #end
    </li>

    <li>
        #@elementItem()
            #@colLabel()预计工时：#end
            #@formControlDiv("col-8")
                <div class="input-group">
                    <input type="text" value="${story?.storyEstimate}" class="form-control" name="storyEstimate"
                           placeholder=""
                           aria-describedby="basic-addon2">
                    <span class="input-group-addon" id="basic-addon2">小时</span>
                </div>
            #end
            #@validateDiv("col-2")#end
        #end
    </li>

    <li>
        #@elementItem()
            #@colLabel()关键词：#end
            #@formControlDiv("col-8")
                #tinyInput("text" "storyKeywords" story?.storyKeywords {"id":"storyKeywords","class":"input-text"})
            #end
            #@validateDiv("col-2")#end
        #end
    </li>

    <li>


        #@elementItem()
            #@colLabel()抄送给：#end
            #@formControlDiv("col-8")
                #@Tselect2F()
                    <script>
                        ajaxRead("${sid}", "storyMailto", "orgUserId", "orgUserRealName", "/org/user/userList", "${story?.storyMailto}");
                    </script>
                    #@Tselect2Body("storyMailto" story?.storyMailto {"class":"input-text select2","multiple":
                        "multiple"}) ##,"multiple":"multiple"加上为多选项
                    #end
                    #@Tselect2Fix()
                        #set(m=menuManager.getMenu("organizationAddUser"))
                        #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                        #end
                        #set(m=menuManager.getMenu("organizationUser"))
                        #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                        #end
                    #end
                #end
            #end
            #@validateDiv("col-2")#end
        #end


</ul>
#end

#@div(divClass="infoContent")
<p class="titleName">需求的一生</p>
<ul>
    <li>
        #@elementItem()
            #@colLabel()由谁创建：#end
            <p> ${UserUtils.getUserById(story?.storyOpenedBy).orgUserRealName}</p>
        #end
    </li>

    <li>
            #@elementItem()
                #@colLabel()指派给：#end
                #@formControlDiv("col-8")
                    #@Tselect2F()
                        <script>
                            ajaxRead("${sid}", "storyAssignedTo", "orgUserId", "orgUserRealName", "/org/user/userList","${story?.storyAssignedTo}");
                        </script>
                        #@Tselect2Body("storyAssignedTo" story?.storyAssignedTo {"class":
                            "input-text select2"}) ##,"multiple":"multiple"加上为多选项
                        #end
                        #@Tselect2Fix()
                            #set(m=menuManager.getMenu("organizationAddUser"))
                            #if(m)
                                <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                            #end
                            #set(m=menuManager.getMenu("organizationUser"))
                            #if(m)
                                <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                            #end
                        #end
                    #end

                #end
                #@validateDiv("col-2")#end
            #end
    </li>
</ul>

</ul>

#end

#@div(divClass="infoContent")
<p class="titleName">其他相关</p>
<ul>
    <li>
        #@elementItem()
            #@colLabel()重复需求：#end
            #@formControlDiv("col-8")
                #tinyInput(
                    "text" "storyDuplicateStory" story?.storyDuplicateStory {"id":"yujigongshi","class":"input-text","datatype":"^[0-9]*$","nullmsg":"内容必须为数字！"})
            #end
            #@validateDiv("col-2")#end
        #end
    </li>

    <li>
        #@elementItem()
            #@colLabel()相关需求：#end
            #@formControlDiv("col-8")
                #tinyInput("text" "storyLinkStories" story?.storyLinkStories {"id":"yujigongshi","class":"input-text","datatype":"^[0-9]*$","nullmsg":"内容必须为数字！"})
            #end
            #@validateDiv("col-2")#end
        #end
    </li>

    <li>
        #@elementItem()
            #@colLabel()细分需求：#end
            #@formControlDiv("col-8")
                #tinyInput(
                    "text" "storyChildStories" story?.storyChildStories {"id":"yujigongshi","class":"input-text","datatype":"^[0-9]*$","nullmsg":"内容必须为数字！"})
            #end
            #@validateDiv("col-2")#end
        #end
    </li>

</ul>
#end
     
