#!set(activeTitle="查入行",activeMenuId=currentPageId)
#@table("itemlist-table")
    #@tbody("databody")
        #@tr(trId="row1")
        <td class="text-c userID" style="width: 2%">1</td>
        <td style="width:18%">
            #@Tselect2F()
                #@Tselect2Body("teamList["+a+"].teamUserId" "" {"class":"input-text select2"})
                    <option></option>
                    #foreach(u : userList)
                        <option value="${u.orgUserId}">${u.orgUserRealName}</option>
                    #end
                #end
                #@Tselect2Fix()
                    <a href="${TINY_CONTEXT_PATH+adminPath}/org/user/form">增加</a>
                    <a href="${TINY_CONTEXT_PATH+adminPath}/org/user/list" class="r">全部</a>
                #end
            #end
        </td>
        <td style="width: 20%">
            #@Tselect2F()
                #@Tselect2Body("teamList["+a+"].teamRole" "" {"class":"input-text select2"})
                    <option></option>
                    #foreach(u : userList)
                        <option value="${u.orgUserId}">${u.orgUserRealName}</option>
                    #end
                #end
                #@Tselect2Fix()
                    <a href="${TINY_CONTEXT_PATH+adminPath}/org/user/form">增加</a>
                    <a href="${TINY_CONTEXT_PATH+adminPath}/org/user/list" class="r">全部</a>
                #end
            #end
        </td>
        <td style="width: 20%">
            #@tinyDateInput("teamList["+a+"].teamJoin" formatDate(now(),"yyyy-MM-dd") "YYYY-MM-DD" )#end
        </td>
        <td style="width: 15%">
            #tinyInput("text" "teamList["+a+"].teamDays" "" {"datatype":"","class":"input-text"})
        </td>
        <td style="width: 15%">
            #tinyInput("text" "teamList["+a+"].teamHours" "" {"datatype":"","class":"input-text"})
        </td>
            #@td("w-p125")
                <div class="operate">
                    #iconOperations(iconOperationsIcon="icon-chevron-down",iconOperationsTitle="添加",iconOperationsCls="btn btn-small btn-default addnext")
                    #iconOperations(iconOperationsIcon="icon-remove",iconOperationsTitle="删除",iconOperationsCls="btn btn-small btn-default delbutton")
                </div>
            #end
        #end
    #end
#end
<script>
    $(function(){
        function updateUserID(){
            $('.itemlist-table>.databody .userID').each(function(index){
                $(this).html(index+1);
            });
        }
        $(".itemlist-table").on("click",".addnext",function(){
            var $thisTr=$(this).closest("tr");
            var $tpl=$thisTr.clone();
                $tpl.find("input:text").val("");
                $tpl.find("td").each(function(){
                    $(this).find("select").each(function(){
                        var name = $(this).attr("name");
                        if(name){
                            var num = name.substring(name.indexOf("[")+1,name.indexOf("]"));
                            var newName = name.substring(0,name.indexOf("[")+1)+(++num)+name.substr(name.indexOf("]"));
                            $(this).attr("name",newName);
                        }
                    });
                    $(this).find("input:text").each(function(){
                        var name = $(this).attr("name");
                        if(name){
                            var num = name.substring(name.indexOf("[")+1,name.indexOf("]"));
                            var newName = name.substring(0,name.indexOf("[")+1)+(++num)+name.substr(name.indexOf("]"));
                            $(this).attr("name",newName);
                        }
                    });
                });
                $thisTr.after($tpl);
                $thisTr.find("div[class=operate]").css("display","none");
            updateUserID();
        }).on("click",".delbutton",function(){
            if($('.databody .userID').size() == 1) return;
            var that=this;
            layer.confirm('确定删除?', function(){
                $(that).closest("tr").remove();
                updateUserID();
                layer.msg('删除成功！',1,1)
            })
        });
    });
</script>