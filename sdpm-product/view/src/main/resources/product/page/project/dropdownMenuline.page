#import("/org/tinygroup/publicComponent/macro/navselect.component")

#if(!cookieProductLineIdTemp&&cookieProductLineId)
<script type="text/javascript">
    $(function(){
        $.cookie('cookieProductLineId', "${cookieProductLineId}", {path: "/"});
    })
</script>
#end
#@navSelect2("productLine" "productLine")
    #@navSelect2Nav()

        #if(cookieProductLineId&&ProductUtils.getProductLineListByUser()?.size()>0)
            #set(finded = 0)
            #foreach(productLine : ProductUtils.getProductLineListByUser())
                #if(productLine?.productLineId == cookieProductLineId)
                    <span id="productLineNameOnTop" value="${cookieProductLineId}"> ${productLine?.productLineName}</span>
                    #set(finded=1)
                #end
            #end
            #if(finded==0)
                #set(cookieProductLineId=null)
            <script type="text/javascript">
                $.removeCookie('cookieProductLineId',{path:"/"})
                window.location.reload();
            </script>
            #end
        #else
            #if(ProductUtils.getProductLineListByUser()?.size()==0)
                #set(lineMsg="目前没有产品线，现在将前往添加。")
                #if(ProductUtils.getProductLineList().size()>0)
                    #set(lineMsg="目前没有你可访问的产品线，现在将前往添加。")
                #end
            <script type="text/javascript">
                $(function(){
                    layer.msg('${lineMsg}<div style="text-align:center"><a href="${TINY_CONTEXT_PATH+adminPath}/productLine/content/add"><span id="showTime">5</span>秒后前往</a></div>',5,-1,function(){
                        window.location.href = "${TINY_CONTEXT_PATH+adminPath}/productLine/content/add";
                    });
                    var timeVal=5;
                    function changeTimeVal(){
                        $("#showTime").html(--timeVal);
                        window.setTimeout(function(){
                            changeTimeVal();
                        },1000);
                    }
                    changeTimeVal();
                })
            </script>
            #end
        #end

<span class="caret"></span>#end
#@navSelect2Body({"style":"left:-18px;top:26px"})
    #@navSelect2Data()
    <option value=""></option>
    <optgroup label="产品线">
        #foreach(productLine : ProductUtils.getProductLineListByUser())
        <option value="${productLine?.productLineId}">${productLine?.productLineName}</option>
    #end
</optgroup>

#end
#@navSelect2Fix()

<a href="${TINY_CONTEXT_PATH +adminPath}/productLine/all" class="r">所有产品线</a>&nbsp;
<!--新增产品-->
<a href="${TINY_CONTEXT_PATH +adminPath}/productLine/add">添加产品线</a>&nbsp;


#end
#end

#hiddenInput("productLineIdHidden","productLineId","","")

<script type="text/javascript">

    $(function () {
        $("#productLine-select").on("change", function () {
            var dataValue = $(this).val();
            $.cookie('cookieProductLineId',dataValue,{path:"/"});
            $.removeCookie("cookieProductId",{path:"/"});
            window.location.reload();
        });
    });

</script>
#end

