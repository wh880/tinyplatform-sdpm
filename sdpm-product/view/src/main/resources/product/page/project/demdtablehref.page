#import("/org/tinygroup/button/components/button_common.component")
#import("/org/tinygroup/button/components/button.component")
#import("/org/tinygroup/table/components/table.component")
#!set(activeTitle="产品概况",activeMenuId=currentPageId)
#!set(linkName="product-demand",sonitem="
<li>"+"需求"+"</li>")

#include("/product/page/event/common.page")
#set(name="version")

<script>
    $(document).ready(function () {

        $(".beizhu").each(function () {
            $(this).unbind("click").bind("click", function () {
                /*if($("#beizhutext").attr("style")==""){
                    $("#beizhutext").hide();
                }else{
                    $("#beizhutext").show();
                }*/

                $("#beizhutext").toggle(1000);


            });
        });

    });
</script>

#@tabWithInit("tab_demo" "optionsBox")

    #hiddenInput("","storyId","",storyId)

    #@div(divClass="operationbar")
    <span class="f">
					<a href="#" class="active_btn">${story?.storyTitle}</a>
			</span>
    <span class="r">

         #foreach(m:menuManager.getScopeMenus("pro_demand_log"))
             #set(url=eval(m?.href))
             #if(m?.map?.type=="aModal")
                 #@aModal("#myModal" m.name "1000" "500" "btn-class" url)#buttonIcon(iconClass=m?.icon)${m?.name}#end
             #elseif(m?.map?.type=="icon-href")
                 <a href="${TINY_CONTEXT_PATH +adminPath}${url}">#buttonIcon(iconClass=m.icon)${m?.name}</a>
             #elseif(m?.map?.type=="icon")
                 <a href="${TINY_CONTEXT_PATH +adminPath}${url}" title="${m?.name}">#buttonIcon(iconClass=m?.icon)</a>
             #elseif(m?.map?.type=="note")
             <a href="${url}" title="${m?.name}">#buttonIcon(iconClass=m?.icon)
             #end
         #end
    </span>
    #end


<div style="width:70%;float:left">
    #@div(divClass="infoContent")
        <p class="titleName">产品描述</p>

        <div>
            ${storySpec?.storySpec}
        </div>
    #end

    #@div(divClass="infoContent")
        <p class="titleName">验收标准</p>

        <div>
            ${storySpec?.storyVerification}
        </div>
    #end

    #@div(divClass="infoContent")
        <p class="titleName">附件</p>


        #foreach(f:file)
            #set(path=f?.filePathname)
            <a href="${path}">${f?.fileTitle}.${f?.fileExtension}</a>&nbsp&nbsp&nbsp&nbsp
            #foreach(m:menuManager.getScopeMenus("product-file-op"))
                #if(m.id == "story-file-edit")
                    #@aModal("#myModal" m.name "400" "120" "class-m" adminPath+m.href+"?fileId="+f?.fileId)
                        #buttonIcon(iconClass=m.icon)#end&nbsp&nbsp&nbsp

                #else
                    #@delItemsdpm(TINY_CONTEXT_PATH+adminPath+m.href f?.fileId )
                        #buttonIcon(iconClass=m.icon)
                    #end
                #end
            #end <br>
        #end

    #end




    #history(adminPath+"/system/action/ajax/history?actionObjectType=story&actionObjectId="+storySpec?.storyId)




    <div style="text-align:center;margin:auto">
<span>
	   #foreach(m:menuManager?.getScopeMenus("pro_demand_log"))
           &nbsp;&nbsp;
           #set(url=eval(m?.href))
           #if(m?.map?.type=="aModal")
               #@aModal("#myModal" m?.name "1000" "500" "btn-class" url)#buttonIcon(iconClass=m?.icon)${m?.name}#end
           #elseif(m?.map?.type=="icon-href")
               <a href="${TINY_CONTEXT_PATH +adminPath}${url}">#buttonIcon(iconClass=m?.icon)${m?.name}</a>
           #elseif(m?.map?.type=="icon")
               <a href="${TINY_CONTEXT_PATH +adminPath}${url}" title="${m?.name}">#buttonIcon(iconClass=m?.icon)</a>
           #elseif(m.map.type=="note")
           <a href="${url}" title="${m?.name}">#buttonIcon(iconClass=m?.icon)
           #end
       #end
</span>
    </div>

    #@tinyForm("thisform" TINY_CONTEXT_PATH +adminPath+"/product/story/remark" "" {"class":"test","enctype":
        "multipart/form-data"})

        #hiddenInput("","storyId","",storyId)
        <div class="infoContent" id="beizhutext" style="display:none">
            <p class="titleName">备注</p>
            #@elementItem()
                #@formControlDiv("col-16")
                    #@Teditor("actionComment" "actionComment" {"initialFrameHeight":"200" ,"datatype":"*10-500"})#end
                #end
                #@validateDiv("col-2")#end
            #end
            <br>

            #@elementItem()
                <div class="col-12">
                    <div class="col-5">

                    </div>
                    <div class="col-1">
                        <button style="float: left" type="submit" id="submit" class="commitBtn">保存</button>
                    </div>
                    <div class="col-1">
                        #@aExtendButton("btn-sm backBtn" "javascript:history.go(-1)")返回#end
                    </div>
                    <div class="col-5"></div>
                </div>
            #end
        </div>

    #end

</div>

<div style="width:30%;float:right">
    #TypeInfo("demandhref" storyId)
</div>


#end
