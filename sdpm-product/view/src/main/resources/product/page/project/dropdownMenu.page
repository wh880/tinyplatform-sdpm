#import("/org/tinygroup/publicComponent/macro/navselect.component")

#@navSelect2("product" "product")
	#@navSelect2Nav()
		#if(cookieProductLineId)
			#if(cookieProductId&&ProductUtils.getProductListByProductLineUser(cookieProductLineId)?.size()>0)
				#set(finded = 0)
				#for(product : ProductUtils.getProductListByProductLineUser(cookieProductLineId))
					#if(product?.productId == cookieProductId)
						${product?.productName}
						#set(finded=1)
					#end
				#end
				#if(finded==0)
                <script type="text/javascript">
                    $.removeCookie('cookieProductId',{path:"/"})
					//window.location.href='http://localhost:8989/sdpm-web/a/project/task/index';
					window.location.reload();
				</script>
				#end
			#else
				#if(ProductUtils.getProductListByProductLineUser(cookieProductLineId)?.size()>0)
				<script type="text/javascript">
					$(function(){
                        $.cookie('cookieProductId', "${ProductUtils.getProductListByProductLineUser(cookieProductLineId)?.get(0)?.productId}", {path: "/"});
						window.location.reload();
					})
				</script>
				#else
                <script type="text/javascript">
                    $(function(){
						var url = window.location.pathname;
						if(url.indexOf("addproduct")<0){
							layer.msg('目前没有产品，现在将前往添加。<div style="text-align:center"><a href="${TINY_CONTEXT_PATH+adminPath}/product/addproduct/addition"><span id="showTime">5</span>秒后前往</a></div>',5,-1,function(){
								window.location.href = "${TINY_CONTEXT_PATH+adminPath}/product/addproduct/addition";
							});
							var timeVal=5;
							function changeTimeVal(){
								$("#showTime").html(--timeVal);
								window.setTimeout(function(){
									changeTimeVal();
								},1000);
							}
							changeTimeVal();
						}
                    })
                </script>
				#end
			#end
		#else
			#if(ProductUtils.getProductLineListByUser()?.size()>0)
            <script type="text/javascript">
                $(function(){
                    $.cookie('cookieProductLineId', "${ProductUtils.getProductLineListByUser()?.get(0)?.productLineId}", {path: "/"});
                    window.location.reload();
                })
            </script>
			#else
##            <script type="text/javascript">
##                $(function(){
##                    layer.msg('目前没有产品线，现在将前往添加。<div style="text-align:center"><a href="${TINY_CONTEXT_PATH+adminPath}/productLine/content/add"><span id="showTime">5</span>秒后前往</a></div>',5,-1,function(){
##                        window.location.href = "${TINY_CONTEXT_PATH+adminPath}/productLine/content/add";
##                    });
##                    var timeVal=5;
##                    function changeTime(){
##                        $("#showTime").html(--timeVal);
##                        window.setTimeout(function(){
##                            changeTime();
##                        },1000);
##                    }
##                    changeTime();
##                })
##            </script>
			#end
		#end

	<span class="caret"></span>#end
	#@navSelect2Body()
		  #@navSelect2Data()
		  <option value=""></option>
		  <optgroup label="产品">
			  #if(cookieProductLineId)
				  #for(product : ProductUtils.getProductListByProductLineUser(cookieProductLineId))
					<option value="${product?.productId}">${product?.productName}</option>
				  #end
		  #end
		  </optgroup>

		#end
		#@navSelect2Fix()

        <a href="${TINY_CONTEXT_PATH +adminPath}/product/allproduct/addition" class="r">所有产品</a>&nbsp;
			<!--新增产品-->
        <a href="${TINY_CONTEXT_PATH +adminPath}/product/addproduct/addition">添加产品</a>&nbsp;


		#end
	#end

#hiddenInput("productIdHidden","productId","","")

	<script type="text/javascript">

		$(function(){
			$("#product-select").on("change",function(){
                var dataValue = $(this).val();
                $.cookie('cookieProductId',dataValue,{path:"/"});
                window.location.reload();
			});
		});
	
	</script>
#end

