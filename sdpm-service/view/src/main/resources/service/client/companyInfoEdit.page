#import("/org/tinygroup/button/components/button_common.component")
#import("/org/tinygroup/button/components/button.component")
#import("/org/tinygroup/table/components/table.component")
#!set(activeTitle="服务管理",activeMenuId=currentPageId)
<style>
    .select_boxes {
        margin-top: 0
    }
</style>
#set(name="client")


#@tinyForm("thisform" TINY_CONTEXT_PATH+"/service/client/clientUserUpdate" "post" {"class":"test"})
<input type="hidden" name="id" value="${clientUser?.id}"/>
<input type="hidden" name="clientId" value="${clientUser?.clientId}"/>
##    #@noRespsGridSystem()
    #@elementItem()
    ##    <span class="c-red">${star}</span>
        #@colLabel("col-3")客户联系人：#end
        #@formControlDiv("col-6")
            #tinyInput("text" "userAccount" clientUser?.userAccount {"datatype":"*","nullmsg":"客户联系人不能为空","id":
                "user_account","class":""})
        #end
        #@validateDiv("col-3")#end
    #end
    #@elementItem()
        #@colLabel("col-3")联系人职务：#end
        #@formControlDiv("col-6")
            #tinyInput("text" "userPost" clientUser?.userPost {"datatype":"","id":"user_post","class":"input-text"})
        #end
        #@validateDiv("col-3")#end
    #end
    #@elementItem()
        #@colLabel("col-3")联系人电话：#end
        #@formControlDiv("col-6")
            #tinyInput(
                "text" "userPhone" clientUser?.userPhone {"datatype":"/^[0-9\.]{11,12}$/","nullmsg":"客户电话不能为空","id":
                "user_phone","class":""})
        #end
        #@validateDiv("col-3")#end
    #end

##    #end
#end

<script type="text/javascript">
    $(function () {
        $("form[name=thisform").Validform({
            tiptype: 2,
            usePlugin: {
                //datepicker:{},//日期控件校验;
                passwordstrength: {
                    minLen: 6,//设置密码长度最小值，默认为0;
                    maxLen: 18,//设置密码长度最大值，默认为30;
                    trigger: function (obj, error) {
                        //该表单元素的keyup和blur事件会触发该函数的执行;
                        //obj:当前表单元素jquery对象;
                        //error:所设密码是否符合验证要求，验证不能通过error为true，验证通过则为false;
                        //console.log(error);
                        if (error) {
                            obj.parent().find(".Validform_checktip").show();
                            obj.parent().find(".passwordStrength").hide();
                        } else {
                            obj.parent().find(".passwordStrength").show();
                        }
                    }
                }
            },
            //ajaxPost:true,
            beforeCheck: function (curform) {
                //在表单提交执行验证之前执行的函数，curform参数是当前表单对象。
                //这里明确return false的话将不会继续执行验证操作;
            },
            beforeSubmit: function (curform) {
                $(curform).ajaxSubmit({
                    dataType: "json",
                    success: function (data) {
                        if (data.status == "y") {
                            layer.msg(data.info, 2, -1);
                        } else {
                            layer.msg(data.info);
                        }
                        try {
                            $(curform).parents(".modal:first").find(".modal-header .close").trigger("click");//弹出框关闭
                            $("table.tinytable").trigger("initnav"); ////可配合TINYTABLE 做刷新
                        } catch (e) {
                        }
                    },
                    error: function () {
                        layer.msg(data.info);
                    }
                });
                return false;

                //在验证成功后，表单提交前执行的函数，curform参数是当前表单对象。
                //这里明确return false的话表单将不会提交;
            }
        });
    });
</script>

