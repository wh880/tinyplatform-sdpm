#setTinyItemCount(pager.totalCount)
#foreach(var:pager.records)
    #@tr()
        #@td()<input type="checkbox" value="${var.clientRequestId}" name="idCheck">#end
    ##        #@td()<a href="${TINY_CONTEXT_PATH}/service/serviceReq/add.page">${var.clientRequestId}</a>#end
        #@td()<a href="${TINY_CONTEXT_PATH}/service/client/clientDetail?id=${var.clientId}">${var.clientName}</a>#end
        #@td()${var.requestTitle}#end
        #@td()${var.requestPre}#end
        #@td()${var.requestStatus}#end
        #@td()${formatDate(var.requestCommitmentDate,"yyyy-MM-dd")}#end
        #@td()${var.replier}#end
        #@td()${var.requestReviewer}#end
        #@td()
            #foreach(m:menuManager.getScopeMenus("service-request"))
                #if(m)
                <a href="${TINY_CONTEXT_PATH}${m.href}?id=${var.clientRequestId}"
                   title="${m.name}">#buttonIcon(iconClass=m.icon)</a>
                #end
            #end

            #set(m1=menuManager.getMenu("request-close"))
            #if(m1)
                #@aModal(
                    "#myModal" m1.name "500" "150" m1.icon m1.href+"?id="+var?.clientRequestId)
                #end
            #end

            #set(m2=menuManager.getMenu("request-delete"))
            #if(m2)
                #@tinyTableItemRemove(TINY_CONTEXT_PATH+m2.href var?.clientRequestId)<i class=${m2.icon}></i>#end
            #end

        #end
    #end
#end
#@simpleModal(myModal)#end

#*macro getMapInfoJson(map) #for(var i:map) ,${var.key}="${var.value}
        "${key}":"${i}"
    #end
#end*#
#macro initBatchAction(map)
<script>
$(function () {
    $("#${tableId} .secondMenu").on("click", function () {
        var inputname = $(this).attr("tabindex");
        var inputvalue = $(this).html().trim();
        var ids = [];
        var href = $(this).attr("href");
        $("#${tableId} input[type='checkbox']").each(function () {
            if (this.checked == true && this.id != "checkboxall") {
                var clientId = $(this).val();
                //if ("records" == inputname) {
                    ids.push(clientId);
               // }
            }
        });
        if (ids.length > 0) {
            $.ajax({
                url: href,
                type: "post",
                traditional: true,
                data: {ids: ids, name: inputvalue},
                dataType: "json",
                success: function (data) {
                   // alert('success');
                    if(data.status=="y") {
                        layer.msg(data.info, 3, 1);
                        $("#${tableId}").trigger("refresh");
                    }else{
                        layer.msg(data.info)
                    }
                },
                error: function (res) {
                    layer.msg("失败")
                    //alert("失败");
                }
            });
        }
        return false;
    });
});
</script>
#end