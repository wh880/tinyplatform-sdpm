<script>
    function ajaxRead(id, toName, opKey, opvalue, url, value,isBuild) {
        var selectCheck = "select[name=" + toName + "]";
        $(selectCheck).each(function () {
            var sele = $(this);
            var s;
            $.ajax({
                type: "POST",
                url: "${TINY_CONTEXT_PATH+adminPath}" + url,
                data: $(this).attr('data'),
                dataType: "json",
                success: function (data) {
                    sele.empty();
                    var em
                    if("build"==(isBuild)){
                        em = "<option value='0' selected  >trunk</option>";
                    }else if("module"==isBuild||"plan"==isBuild){
                        em = "<option value='0' selected  >/</option>";
                    }
                    sele.append(em);
                    for (var i = 0, l = data.length; i < l; i++) {
                        var em = "<option value='" + data[i][opKey] + "' >" + data[i][opvalue] + "</option>";
                        sele.append(em);

                    }
                    if ("multiple" != sele.attr("multiple")) {
                        if (value) {
                            sele.select2("val",value).trigger("change");
                        } else {
                            sele.select2("val","").trigger("change");
                        }
                    }else{
                        if (value != null) {
                            var values = value.split(",");
                            if(values.length>1){
                                sele.val(values).trigger("change");
                            }else{
                                sele.val(value).trigger("change");
                            }
                        }
                        else{
                            sele.select2("val","");
                        }
                    }
                },
                error: function (res) {
//                    alert("失败"+toName);
                }
            });
        });
    }
</script>

    #@tabWithInit("tab_demo" "optionsBox")
        #@div(divClass="dropdownBox")
            #include("/document/common/dropdownMenu.page")
        #end
        #@tabHead()
            #foreach(m in menuManager.getChildMenus("idocument"))
                #@aHeadCol(TINY_CONTEXT_PATH+adminPath+m.href "Current")${m.name}#end
            #end
        <span class="r" style="position:relative;top:2px;height:0">
            #foreach(m:menuManager.getScopeMenus("file-op"))
                #if(m.id == "doc-file-edit"&&Integer.parseInt(documentLibId)>2)
                    #@aModal("#myModal" m.name "400" "160" "class-m" adminPath+m.href)
                        #buttonIcon(iconClass=m.icon)${m.name}#end&nbsp
                #elseif(Integer.parseInt(documentLibId)>2)
                    #@delItemsdpm(TINY_CONTEXT_PATH+adminPath+m.href documentLibId TINY_CONTEXT_PATH+adminPath+
                        "/document")
                        #buttonIcon(iconClass=m.icon)${m.name}#end&nbsp
                #end
            #end
            #set(m=menuManager.getMenu("doclib-add"))
            #if(m)
                #@aModal("#myModal" m.name "400" "160" "class-m" adminPath+m.href)
                    #buttonIcon(iconClass=m.icon)${m.name}#end
            #end
        </span>
        #end
        #layout(document)#end
    #end


#pageContent

#@dialog("myModal")
    #@dialogHeader()#end
    #@dialogBody()<p></p>#end
    #@dialogFooter()
    #end
#end