<script type="text/javascript">


    function ajaxRead(id,toName,opKey,opvalue,url,value){
        var selectCheck = "select[name="+toName+"]";
        $(selectCheck).each(function(){
            var sele = $(this);
            var s;
            $.ajax({
                type: "POST",
                url: "${TINY_CONTEXT_PATH+adminPath}"+url,
                data: $(this).attr('data'),
                dataType:"json",
                success: function(data){
                    sele.empty();
                    var em = "<option value='0' selected  >/</option>";
                    sele.append(em);
                    for(var i=0,l=data.length;i<l;i++){
                        var em = "<option value='"+data[i][opKey]+"' >"+ data[i][opvalue] +"</option>";
                        sele.append(em);

                    }

                    if(value!=null) {
                        sele.val(value).trigger("change");
                    }else {
                        sele.val(data[0][opKey]).trigger("change");
                    }


                },
                error: function(res){
                  ##  alert("失败");
                }
            });


        });

    }
</script>


#import("/org/tinygroup/form/components/form.component")
#import("/org/tinygroup/icon/components/icon.component")
#import("/org/tinygroup/button/components/button_common.component")
#import("/org/tinygroup/button/components/button.component")
#macro radio1(rId rName rChecked rValue rClass rIsDisabled radioOther)
 <input#if(rId) id="$!{rId}"#{end}#if(rName) name="$!{rName}"#end#if(rChecked && rChecked=="checked") checked#{end}#if(rValue) value="$!{rValue}"#end#if(rClass) class="$!{rClass}"#end#if(rIsDisabled && rIsDisabled=="disabled") disabled#end type="radio" onclick="${radioOther}"/>
#end
#macro labelRadio1(rId rName rValue rClass radioOther labelText)
	#@radioBox()
		#radio1(rId=rId rName=rName rValue=rValue rClass=rClass radioOthe=radioOther)
		#@label(ckId)${labelText}#end
	#end
#end
#include("doc-tab.page")
#@tinyForm("thisform" TINY_CONTEXT_PATH+adminPath+"/document/doc/addSave" "post" {"class":"add","enctype":"multipart/form-data"})
#*<input type="hidden" name="docLibId" value="${doc?.docLibId}"/>
<input type="hidden" name="docId" value="${doc?.docId}"/>*#
	<div style="width:100%">
    	<div class="infoContent">
    		<p class="titleName">创建文档</p>
			 #@elementItem()
					#@colLabel()所属项目#end
					#@formControlDiv("col-8")
					#@div(divClass="col-5")
						
					#@Tselect2F()
	                   		#@Tselect2Body("docProject" doc?.docProject?:0 {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
	                        <option value="0">/</option>
	                        #foreach(project : projectList)
	                        	#if(project?.projectDeleted !="1")
	                        	 	<option value="${project?.projectId}">${project?.projectName}</option>
	                        	#end
	                        #end	                       	                    	                        
	                    	#end 
	                    	
                        	
                        	
	                    	#@Tselect2Fix()
	                    	<a href="${TINY_CONTEXT_PATH+adminPath}/project/preadd" class="r">增加</a>
	                    	<a href="${TINY_CONTEXT_PATH+adminPath}/project/allProject">全部</a>#end  
	                    	<script type="text/javascript">
                            $("#${sid}").on("change",function(){
                                var pId = $("#${sid}  option:selected").val();
                                ajaxRead("${sid}","docProduct","productId","productName","/document/ajax/product?projectId="+pId,${doc?.docProduct?:0});

                            })
                        	</script>
                        	
	                    	<script type="text/javascript">
	                            $("#${sid}").on("change",function(){
	                                var pId = $("#${sid}  option:selected").val();
	                                ajaxRead("${sid}","docModule","moduleId","moduleName","/document/ajax/module?projectId="+pId,${doc?.docModule?:0});
	
	                            })
           			 		</script>                	                    	
                	  #end
                	  #end
                	  #end
	 		#end	
	 				
    		 #@elementItem()
					#@colLabel()所属产品#end
					#@formControlDiv("col-8")
					#@div(divClass="col-5")
					#@Tselect2F()
	                   		#@Tselect2Body("docProduct" doc?.docProduct {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
								<option value="0">/</option>
	                    	#end                  
	                    	#@Tselect2Fix()
	                    	<a href="${TINY_CONTEXT_PATH+adminPath}/product/addproduct/addition" class="r">增加</a>
	                    	<a href="${TINY_CONTEXT_PATH+adminPath}/product/allproduct/addition">全部</a>#end
                	  #end
                	  #end
                	  #end
			#end	
	
			#@elementItem()
					#@colLabel()所属分类#end
					#@formControlDiv("col-8")
					#@div(divClass="col-5")
					#@Tselect2F()
	                   	#@Tselect2Body("docModule" "IN" {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
	                        <option value="0">/</option>	                       	            
	                    #end                  	                    	
                	  #end
                	  #end
                	   #end
				#end	
				
			#@elementItem()
        			#@colLabel()文档类型#end
					#@skinMinimal("mt-20")
    					#labelRadio1(rId="typefile" rName="docType" rChecked="checked" rValue="文件" "setType(this.value);" labelText="文件")
    					#labelRadio1(rId="typeurl" rName="docType" rValue="链接" labelText="链接" "setType(this.value);")   								
    					#labelRadio1(rId="typetext" rName="docType" rValue="网页" labelText="网页" "setType(this.value);")
					
					#end
        			#@validateDiv("col-2")#end
      		#end	
							
			#@elementItem()
					#@colLabel()<span class="c-red">*</span>文档标题#end
					#@formControlDiv("col-8")
					#@div(divClass="col-5")
					#tinyInput("text" "docTitle" "" {"datatype":"*1-16","nullmsg":"标题不能为空！","placeholder":"1~16个字符，字母/中文/数字/下划线","class":"input-text"})
					#end
					#end	
					#@validateDiv("col-2")#end

				#end
			#@elementItem(elementId="urlBox" eleItemClass="hidden")
					#@colLabel()<span class="c-red">*</span>文档URL#end
					#@formControlDiv("col-8")
					#@div(divClass="col-5")
					#tinyInput("text" "docUrl" ""{"placeholder":"相应的链接地址","datatype":"*4-16","nullmsg":"链接不能为空！","id":"docUrl","class":"input-text"})
					#end
					#end
					#@validateDiv("col-2")#end
				#end
											
			#@elementItem()	
					#@colLabel()关键字#end
					#@formControlDiv("col-8")
					#@div(divClass="col-5")
					#tinyInput("text" "docKeywords" ""{"placeholder":"","id":"docKeywords","class":"input-text"})
					#end
					#end
				#end
				#@validateDiv("col-2")#end
											
			#@elementItem()
					#@colLabel()文档摘要#end
					#@formControlDiv("col-8")
						#@Teditor("docDigest" "docDigest" {"initialFrameHeight":"200"})#end
					#end
					#@validateDiv("col-2")#end
				#end	
										
			#@elementItem(elementId="fileBox")
				#@colLabel()附件：#end
				#@formControlDiv("col-8")					
					#include("fileupload.page")
#*					#tinyUploadInput("inputName" "" {"placeholder":"可直接输入地址，也可点击下图标进行上传"})*#				
				#end
				#@validateDiv("col-2")#end
			#end
			#@elementItem(elementId="contentBox" eleItemClass="hidden")
					#@colLabel()文档正文#end
					#@formControlDiv("col-8")
						#@tinyueditor("docContent" "docContent")#end
					#end					
					#@validateDiv("col-2")#end
			#end
    #@elementItem()
        <div class="col-12">
            <div class="col-2">

            </div>
            <div class="col-1">
                <button style="float: left" type="submit" id="submit" class="commitBtn">保存</button>
            </div>
            <div class="col-1">
            	#@aExtendButton("btn-sm backBtn" "javascript:history.go(-1)")返回#end
            </div>
            <div class="col-5"></div>
        </div>
    #end
#end


<script type="text/javascript">
/* Set doc type. */
function setType(type)
{
	if(type == '链接')
	{
		$('#urlBox').removeClass('hidden');
		$('#fileBox').addClass('hidden');
		$('#contentBox').addClass('hidden');
	}
	else if(type == '网页')
	{
		$('#urlBox').addClass('hidden');
		$('#fileBox').addClass('hidden');
		$('#contentBox').removeClass('hidden');
	}
	else
	{
		$('#urlBox').addClass('hidden');
		$('#fileBox').removeClass('hidden');
		$('#contentBox').addClass('hidden');
	}
}
</script>
<script type="text/javascript">
    $(function () {
        $("form[name=thisform]").Validform({
            tiptype: 2
        });
    });
</script>

#*
<script type="text/javascript">
     var 产品=[
     for(int i=0;i<${projectList}.length;i++){
     	[for(int j=0;j<${productList}.length)
     	]
     	}
     ];

     function getCity(){
         //获得省份下拉框的对象
         var sltProvince=document.form1.province;
         //获得城市下拉框的对象
         var sltCity=document.form1.city;         
         //得到对应省份的城市数组
         var provinceCity=city[sltProvince.selectedIndex - 1];
 
         //清空城市下拉框，仅留提示选项
         sltCity.length=1;
 
         //将城市数组中的值填充到城市下拉框中
         for(var i=0;i<provinceCity.length;i++){
             sltCity[i+1]=new Option(provinceCity[i],provinceCity[i]);
         }
     }
 </script>*#