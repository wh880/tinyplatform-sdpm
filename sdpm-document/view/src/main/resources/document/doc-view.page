#import("/org/tinygroup/form/components/form.component")
#import("/org/tinygroup/bootstrapDate/components/bootstrapDate.component")
#import("/org/tinygroup/button/components/button_common.component")
#import("/org/tinygroup/button/components/button.component")
#import("/org/tinygroup/fold/components/fold.component")
#set(name="documentDocu")
#include("doc-tab.page")
#@div()
	#@p(pClass="title_sty")
		<span class="f"> 文档名称</span>
		<span class="r">
			#foreach(m:menuManager.getScopeMenus("doc-view-op"))
				#if(m.id == "doc-view-delete")
					#@delItemsdpm(TINY_CONTEXT_PATH+adminPath+m.href doc?.docId TINY_CONTEXT_PATH+adminPath+"/document")
						#buttonIcon(iconClass=m.icon)
					#end&nbsp
				#else
				#if(m.id == "doc-view-edit")
					<a href="${TINY_CONTEXT_PATH+adminPath}${m.href}?docId=${doc?.docId}" title="${m.name}">
						#buttonIcon(iconClass=m.icon)</a>&nbsp
				#else
					<a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" title="${m.name}">
						#buttonIcon(iconClass=m.icon)</a>&nbsp
				#end	
				#end
			#end											
		</span>
	#end
<div style="width:70%;float:left" class="pageleftpart">
	#@div(divClass="infoContent")
        <p class="titleName">文档摘要</p>
        ${doc?.docDigest}
    #end
    #@div(divClass="infoContent")
        <p class="titleName">关键字</p>
        ${doc?.docKeywords}
    #end
    #@div(divClass="infoContent")
    #if(doc?.docType=='链接')
        <p class="titleName">文档URL </p>
        ${doc?.docUrl}
    #elseif(doc.docType=='文件')<p class="titleName">附件 </p>
    #foreach(f : file)   	
    	 #set(path=f?.filePathname)
    		<a href="${path}">${f?.fileTitle}.${f?.fileExtension}</a>&nbsp&nbsp&nbsp&nbsp
    		#foreach(m:menuManager.getScopeMenus("file-op"))
				#if(m.id == "file-edit")					
    				#@aModal("#myModal" m.name "400" "120" "class-m" adminPath+m.href+"?fileId="+f?.fileId)
        	        	#buttonIcon(iconClass=m.icon)#end&nbsp
        	    #else
        	    	#@delItemsdpm(TINY_CONTEXT_PATH+adminPath+m.href f?.fileId )
						#buttonIcon(iconClass=m.icon)
					#end<br>
#*        	    	#@tinyTableItemRemove(TINY_CONTEXT_PATH+adminPath+m.href f?.fileId)
						<i class="${m.icon}" title="删除"></i>
					#end<br>*#
        	    #end
        	#end    		
    #end
   
    #else <p class="titleName">网页</p>
    ${doc?.docContent}
    #end
    #end
#*    #@div(divClass="infoContent")
        <p class="titleName">历史记录</p>*#
        	#history(adminPath+"/system/action/ajax/history?actionObjectType=doc&actionObjectId="+doc?.docId)
        	###include("../data/historyRecord.page")
#*    #end*#
    <center>		
		#foreach(m:menuManager.getScopeMenus("doc-view-op"))
				#if(m.id == "doc-view-delete")
					#@delItemsdpm(TINY_CONTEXT_PATH+adminPath+m.href doc?.docId TINY_CONTEXT_PATH+adminPath+"/document")
						#buttonIcon(iconClass=m.icon)
					#end&nbsp
				#else
				#if(m.id == "doc-view-edit")
					<a href="${TINY_CONTEXT_PATH+adminPath}${m.href}?docId=${doc?.docId}" title="${m.name}">
						#buttonIcon(iconClass=m.icon)</a>&nbsp
				#else
					<a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" title="${m.name}">
						#buttonIcon(iconClass=m.icon)</a>&nbsp
				#end	
				#end
		#end
	</center>
</div>
<div style="width:30%;float:right;">
		#TypeInfo("docInfo" doc?.docId)
 ##    #include("basic-info.page")
</div>
#end
		
##遗漏的弹出框
<script type="text/javascript">

    $(function(){
        var minTop=96;
        var maxTop=153;
        var currenttop=maxTop;
        function doscroll(){
            currenttop=maxTop-parseInt($(window).scrollTop());
            if(currenttop<minTop) currenttop=minTop;
            $(".rightpart").css("top",currenttop+"px");
        }
        var timer_scroll;
        $(window).scroll(function(){
            clearTimeout(timer_scroll);
            setTimeout(function() {
                doscroll();
            },10);
        })
    })
</script>