#!set(activeTitle="组织管理",activeMenuId=currentPageId)

#import("/common/component/form.component")
#set(editpagePath=
    "/organization/common/fileOutput.pagelet",editpageModalId="userEditModal",editpageModal="#"+editpageModalId)

#include("/common/common.page")
<style>
    .tabLayout .tabBar span a {
        color: #333
    }

    .tabLayout .tabBar .Current a {
        color: #fff
    }

    .operationbar {
        border-top: none;
        background: #f9fafe;
        padding: 6px 5px 6px 10px;
    }

</style>
#set(name="organizationUser")
#@div()

    #@tabWithInit("tab_demo" "optionsBox")
        #@tabHead()
            #include("/organization/common/tab.page")
        #end
        #@tabBodyCol("ptop-5")
            #@div(divClass="operationbar")
                #@tinyForm("thisform" "" "" {"class":"test"})
                    #@formControlDiv("col-1")
                        #@navSelect2("user" "user")
                            #@navSelect2Nav()
                                #if(userList)
                                    #for(user:userList)
                                    #if(user?.orgUserId == id)
                                        ${user?.orgUserRealName}
                                    #end
                                #end
                            #else
                            用户
                            #end

                        <span class="caret"></span>#end
                        #@navSelect2Body()
                            #@navSelect2Data()
                            <option value=""></option>
                            <optgroup label="用户">
                                #for(user:userList)
                                <option value="${user?.orgUserId}">${user?.orgUserRealName}</option>
                            #end
                        </optgroup>

                        #end
                        #@navSelect2Fix()
                        <a href="${TINY_CONTEXT_PATH +adminPath}/org/user/list" class="r">所有用户 </a>&nbsp;
                        <a href="${TINY_CONTEXT_PATH +adminPath}/org/user/form">添加用户</a>&nbsp;
                        #end
                    #end
                    #hiddenInput("userIdHidden","orgUserId","","")
                <script type="text/javascript">

                    $(function () {
                        $("#user-select").on("change", function () {
                            window.location.href = "${TINY_CONTEXT_PATH +adminPath}/org/user/bug?choose=3&id=" + $(this).val();
                        });
                    });

                </script>
                #end

            #end
        <span style="float: left;">
                    &nbsp;&gt;
                    #foreach(m:menuManager.getScopeMenus("org-user-detail"))
                        #if(m.id=="org-user-bugAdmin")
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}?choose=3&id=${id}"
                               class="active_btn">${m.name}</a>
                        #else
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}?choose=3&id=${id}">${m.name}</a>
                        #end
                    #end
                </span>
                    #div(divClass="clearfix")
                #end

            <span class="barBoxs">
                <a href="${TINY_CONTEXT_PATH+adminPath}/org/user/bug?choose=3&id=${id}"
                   class="${choose == 3?'active_btn':''}">指派给他</a>
                <a href="${TINY_CONTEXT_PATH+adminPath}/org/user/bug?choose=4&id=${id}"
                   class="${choose == 4?'active_btn':''}">由他创建</a>
                <a href="${TINY_CONTEXT_PATH+adminPath}/org/user/bug?choose=5&id=${id}"
                   class="${choose == 5?'active_btn':''}">由他解决</a>
                <a href="${TINY_CONTEXT_PATH+adminPath}/org/user/bug?choose=6&id=${id}"
                   class="${choose == 6?'active_btn':''}">由他关闭</a>
        </span>
            #end
        #end
    #end

#end


#@tinyTable() ##ID为空则系统自动生成 带入参数则取该参数为ID
    #@div(divClass="tinyheaderTools form-inline")
        #setTinyTablePageSize([8,10,20,50,100,200])
    #end
    #@tinyTableContent(TINY_CONTEXT_PATH+adminPath+"/org/user/bug/search?"+tinyRequestQueryString) ##取数据地址 总数据
        #@thead()
            #@tr()###th  class 为sorting 表票可排序 为sorting_desc 为当前倒序
                #@tinyTh({"class":"","rel":"bug_id"})ID#end
                #@tinyTh({"class":"","rel":"bug_severity"})级别#end
                #@tinyTh({"class":"","rel":"priority"})P#end
                #@tinyTh({"class":"","rel":"bug_title"})BUG标题#end
                #@tinyTh({"class":"","rel":"bug_opened_by"})创建#end
                #@tinyTh({"class":"","rel":"bug_resolved_by"})解决者#end
                #@tinyTh({"class":"","rel":"bug_resolution"})方案#end
            #end
        #end
    #end
#end

#simpleModal(editpageModalId)

