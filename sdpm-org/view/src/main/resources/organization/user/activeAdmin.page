#!set(activeTitle="组织管理",activeMenuId=currentPageId)
#import("/common/component/form.component")
#set(editpagePath=
    "/organization/user/fileOutput.pagelet",editpageModalId="userEditModal",editpageModal="#"+editpageModalId)

#include("/common/common.page")
#set(name="organizationUser")
#@div()
    #@tabWithInit("tab_demo" "optionsBox")
        #@tabHead()
            #include("/organization/common/tab.page")
        #end
        #@tabBodyCol("ptop-5")
            #@div(divClass="operationbar")
                #@tinyForm("thisform" "" "" {"class":"test"})
                    #@formControlDiv("col-1")
                        #@navSelect2("user" "user")
                            #@navSelect2Nav()
                                #if(userList)
                                    #for(user:userList)
                                    #if(user?.orgUserId == id)
                                        ${user?.orgUserRealName}
                                    #end
                                #end
                            #else
                            用户
                                #end
                        <span class="caret"></span>#end
                        #@navSelect2Body()
                            #@navSelect2Data()
                            <option value=""></option>
                            <optgroup label="用户">
                                #for(user:userList)
                                <option value="${user?.orgUserId}">${user?.orgUserRealName}</option>
                            #end
                        </optgroup>

                        #end
                        #@navSelect2Fix()
                        <a href="${TINY_CONTEXT_PATH +adminPath}/org/user/list" class="r">所有用户 </a>&nbsp;
                        <a href="${TINY_CONTEXT_PATH +adminPath}/org/user/form">添加用户</a>&nbsp;
                        #end
                        #end
                    #hiddenInput("userIdHidden","orgUserId","","")

                <script type="text/javascript">

                    $(function () {
                        $("#user-select").on("change", function () {
                            window.location.href = "${TINY_CONTEXT_PATH +adminPath}/org/user/active?choose=3&id=" + $(this).val();
                        });
                    });

                </script>
                #end
            #end
        <span style="float: left;">
                    &nbsp;&gt;
                    #foreach(m:menuManager.getScopeMenus("org-user-detail"))
                        #if(m.id=="org-user-activeAdmin")
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}?choose=3&id=${id}"
                               class="active_btn">${m.name}</a>
                        #else
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}?choose=3&id=${id}">${m.name}</a>
                        #end
                    #end

                </span>
            #div(divClass="clearfix")
                #end

            <span class="barBoxs">
                <a val="1" class="selDate">今天</a>
                <a val="2" class="selDate">昨天</a>
                <a val="3" class="selDate">前天</a>
                <a val="4" class="selDate">本周</a>
                <a val="5" class="selDate">上周</a>
                <a val="6" class="selDate">本月</a>
                <a val="7" class="selDate">上月</a>
                <a val="0" class="selDate">所有</a>
        </span>
            #end
        #end

    #end

#end
#@tinyTable("userDynamicTable") ##ID为空则系统自动生成 带入参数则取该参数为ID
    #@div(divClass="tinyheaderTools form-inline")
        #setTinyTablePageSize([8,10,20,50,100,200])
    #end
    #@tinyTableContent(TINY_CONTEXT_PATH+adminPath+"/org/user/active/search?"+tinyRequestQueryString) ##取数据地址 总数据
        #@thead()
            #@tr()###th  class 为sorting 表票可排序 为sorting_desc 为当前倒序
                #@tinyTh({"class":"","rel":"action_date"})日期#end
                #@tinyTh({"class":"","rel":"actor_name"})操作者#end
                #@tinyTh({"class":"","rel":"action_action"})动作#end
                #@tinyTh({"class":"","rel":"action_object_type"})对象类型#end
                #@tinyTh({"class":"","rel":"action_id"})ID#end
                #@tinyTh({"class":"","rel":"object_name"})对象名称#end
            #end
        #end
    #end
#end

#simpleModal(editpageModalId)

<script>
    $(function () {
        var actionUrl = $("#userDynamicTable").attr("data-url");
        $(".selDate").click(function (e) {

            $("#userDynamicTable").attr("data-url", actionUrl + "&selDate=" + $(this).attr("val"));
            $(".selDate").removeClass("active_btn");
            $(this).addClass("active_btn");
            $("#userDynamicTable").trigger("refresh");

            return false;
        });

    });
</script>