
#macro Teditor(sstid textareaEditorName tbMap)#set(tid=tbMap?.id?:fmt("tid%d",rand()))
<textarea id="${tid}" name="${textareaEditorName}" #mapToHtml(tbMap)>#bodyContent</textarea>
<script type="text/javascript">
    $(function(){
        $('#${tid}').trumbowyg({
            lang:"zh_cn",
            closable: false,
            mobile: true,
            fixedBtnPane: false,
            fixedFullWidth: true,
            btnsDef: {
                align: {
                    dropdown: ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull'],
                    ico: 'justifyLeft'
                },
            },
            btns: ['viewHTML','bold','|', 'italic','|', "link" ,'|','formatting','|', 'align','|', 'btnGrp-lists','|', 'foreColor', 'backColor','|', 'horizontalRule'],
            autoAjustHeight: false,
            height:300,

        });
    })
</script>
#end

#set(name="task")
#@tinyForm(
    "thisform" TINY_CONTEXT_PATH+adminPath+"/project/task/finish" "post" {"class":"test","enctype":"multipart/form-data"})
    #hiddenInput(hiddenInputName="taskId" hiddenInputValue=task?.taskId)
<div style="width:70%;float:left" class="pageleftpart">
    <div class="infoContent">
        <p class="titleName">${task?.taskName}>完成</p>
        #@elementItem()
            #@colLabel()总消耗#end
            #@formControlDiv("col-8")
                #tinyInput("text" "taskConsumed" task.taskConsumed {"placeholder":"总消耗时间","id":"comsume-time","class":
                    "input-text",
                    "datatype":"*4-16","nullmsg":"请输入总消耗时间（小时）"})
            #end
            #@validateDiv("col-2")#end
        #end
        #@elementItem()
            #@colLabel()指派给#end
            #@formControlDiv("col-8")
                #@Tselect2F()
                    #@Tselect2Body("taskAssignedTo" task.taskAssignedTo {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
                        #foreach(t : teamList)
                            <option value="${t.orgUserId}">
                                ${t.orgUserRealName}
                            </option>
                        #end
                    #end
                    #@Tselect2Fix()
                        #set(m=menuManager.getMenu("organizationAddUser"))
                        #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                        #end
                        #set(m=menuManager.getMenu("organizationUser"))
                        #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                        #end
                    #end
                #end
            #end
            #@validateDiv("col-2")#end
        #end
        #@elementItem()
            #@colLabel()完成时间#end
            #@formControlDiv("skin-minimal col-5")
                #@tinyDateInput(
                    "taskFinishedDate" formatDate(now(),"yyyy-MM-dd") "yyyy-MM-dd" {"datatype":"*","placeholder":"选择完成时间"})
                #end
            #end
            #@validateDiv("col-2")#end
        #end
        #@elementItem()
            #@colLabel()附件#end
            #@formControlDiv("col-8")
                #mulUploadFile()
            #end
            #@validateDiv("col-2")#end
        #end

    ##
        #@elementItem()
            #@colLabel()备注#end
            #@formControlDiv("col-8")
                #@Teditor("content" "comment22" {"initialFrameHeight":"200"})#end
            #end
            #@validateDiv("col-2")#end
        #end
    </div>
    #@elementItem()
        <div class="col-12">
            <div class="col-5"></div>
            <div class="col-1">
                <button style="float: left" type="submit" id="submit2" class="commitBtn">保存</button>
            </div>
            <div class="col-1">
                #@aExtendButton("btn-sm backBtn" "javascript:history.go(-1)")取消#end
            </div>
            <div class="col-5"></div>
        </div>
    #end
    <br>
</div>
#end
<div style="width:30%;float:right">
    #history(adminPath+"/system/action/ajax/history?actionObjectType=task&actionObjectId="+task.taskId)
</div>
<script>
    $(function(){
        $("form[name=thisform]").Validform({
            beforeSubmit:function(){
                console.log($("[name=comment22]").val());
                return false;
            }

        })
    })
</script>