##import("/org/tinygroup/table/components/togglebox.component") 宏文件所在位置
#!set(activeMenuId=currentPageId)

#@toggleBox({"class":"open"})##展开为class:OPEN 要附加其它的属性请用MAP带入
    #@toggleLeft({"class":"aclass"})
        #@settoggleLeftTitle()
            #if(currentProjectId)
                ${CmsUtils.getProject(currentProjectId).projectName}
            #else
                ${CmsUtils.getProjectList().get(0).projectName}
            #end
        #end
        #@settoggleLeftBody("treeLeftbox")
            #include("/project/task/moduleTree.page")
        #end
    #end

    #@toggleRight()
        #@tinyTable("taskTable") ##ID为空则系统自动生成 带入参数则取该参数为ID
            #@div(divBaseClass="tinyheaderTools form-inline")
                #setTinyTablePageSize([10,20,50,100,200,35])
            <input type="button" value="全选" class="btn btn-default btn-primary "
                   onclick="selectAllNullorReserve('idCheck','全选');"/>
            <input type="button" value="反选" class="btn btn-default btn-primary"
                   onclick="selectAllNullorReserve('idCheck','反选');"/>
            <a class="btn btn-success" href="${TINY_CONTEXT_PATH+adminPath}/project/task/preadd">建任务</a>
            #end
        ###set(requestStatuString = tinyRequestQueryString!=null ?"&"+tinyRequestQueryString:"")
            #if(moduleId)
                #set(requestStatuString = "&moduleId=" + moduleId)
            #end
            #if(choose)
                #set(requestStatuString = "&choose=" + choose)
            #end
            #@tinyTableContent(TINY_CONTEXT_PATH+adminPath+
                "/project/task/findPager?projectId="+cookie_projectId+requestStatuString) ##取数据地址 总数据
                #@thead()
                    #@tr()  ##class 为sorting 表票可排序 为sorting_desc(正序为为sorting_asc) 为当前倒序
                        #@tinyTh({"width":"6"})<input type="checkbox" name="allck" value="">#end
                        #@tinyTh({"class":"sorting","rel":"task_id"})ID#end
                        #@tinyTh({"class":"sorting","rel":"task_pri"})P#end
                        #@tinyTh({"class":"sorting","rel":"task_name"})任务名称#end
                        #@tinyTh({"class":"sorting","rel":"task_statu","style":"color:#f00"})状态#end
                        #@tinyTh({"class":"sorting","rel":"task_endline"})截止#end
                        #@tinyTh({"class":"sorting","rel":"task_open_by"})创建#end
                        #@tinyTh({"class":"sorting","rel":"task_assigned_to"})指派给#end
                        #@tinyTh({"class":"sorting","rel":"task_finished_by"})完成者#end
                        #@tinyTh({"class":""})操作#end
                    #end
                #end

            #end
        ##以下部分为对删除和修改的影响 因为存在不同的信息故放在外面自行更改 #dialog 配合修改使用
        ##个人认为下面的js及dialog无用，先完成页面效果。2015年9月8日 10:09:33
        <script type="text/javascript">
            $(function () {
                $('#${tableId}').on('click', '.delBtn', function (e) {
                    user_del(this, '1');
                });
            })
        </script>
            #@dialog("myModal")
                #@dialogHeader()对话框标题#end
                #@dialogBody()<p>对话框内容…</p>#end
                #@dialogFooter()
                    #@buttonEnsure()确定#end
                    #@buttonCancel()关闭#end
                #end
            #end
        #end
    #end
#end
