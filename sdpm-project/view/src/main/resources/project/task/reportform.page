#import("/org/tinygroup/form/components/form.component")
#import("/org/tinygroup/icon/components/icon.component")
#import("/org/tinygroup/button/components/button_common.component")
#import("/org/tinygroup/button/components/button.component")
#import("/org/tinygroup/pieCharts/components/pieCharts.component")
#!set(activeTitle="项目管理",activeMenuId=currentPageId)
<style>
    .togglebox.open .tableBoxessty {
        margin-left: 262px
    }

    .togglebox.open .togglenavico {
        left: 218px
    }

    .togglebox .togglenavpart {
        left: -260px;
    }
</style>
<script>
    $(document).ready(function () {
        $(".but1").unbind("click").bind("click", function () {
            $(".navbody input[type='checkbox']").each(function () {
                this.checked = true
            });
        });

        $(".but2").unbind("click").bind("click", function () {
            $(".navbody input[type='checkbox']").each(function () {
                this.checked = !this.checked;
            });
        });

    });
</script>
#macro toggleRight(toggleRightClass)
<div id="${toggleid}-body" class="trans togglebodypart ${toggleRightClass}">
    #bodyContent
</div>
#end
#@div()
    #@tabWithInit("tab_demo" "optionsBox")
        #@tabBodyCol("ptop-5")
        ##operationbar start1
            #@div(divClass="operationbar")
            <span class="f">
		<font class="active_btn">报表</font>
	</span>
                #div(divClass="clearfix")
            #end
        ##operationbar end
        #end
    #end
#end
#@toggleBox({"class":"open"})##展开为class:OPEN 要附加其它的属性请用MAP带入
    #@toggleLeft({"class":"aclass","style":"width:250px;height:450px;overflow:auto"})
        #@settoggleLeftTitle()请选择报表类型#end
        #@settoggleLeftBody()
        ##            #@Tcheckboxes("array" "")
            #@skinMinimal()
                #foreach(t:getDict("chartType"))
                ##@tinyCheckBox(t?.value)${t?.text}#end
                    #labelCheckbox(ckName="array" ckId="cid"+t.value labelText=t.text)
                #end
            <script>
                $(function () {
                    $("#buildChart").click(function (e) {
                        console.log("gg");
                        var list = [];
                        $(".togglebox input:checkbox").each(function (i) {
                            if (this.checked) {
                                list.push($(this).attr("id").substring(3));
                            }
                        });

                        $.ajax({
                            url: "${TINY_CONTEXT_PATH+adminPath}/project/task/buildChart",
                            dataType: "json",
                            data: {ids: list.join(",")},
                            success: function (data) {
                                $("#chart").html(data);
                                //刷新数据
                            },
                            error: function (data) {
                                layer.msg(data.info, 2, 9);
                            }
                        });
                    });
                });
            </script>
            ##                #labelCheckbox(ckId="checkbox-1" labelText="项目任务统计")
            ##                #labelCheckbox(ckId="checkbox-3" labelText="版本Bug数量")
            ##                #labelCheckbox(ckId="checkbox-4" labelText="模块Bug数量")
            ##                #labelCheckbox(ckId="checkbox-5" labelText="每天新增Bug数")
            ##                #labelCheckbox(ckId="checkbox-6" labelText="每天解决Bug数")
            ##                #labelCheckbox(ckId="checkbox-7" labelText="每天关闭的Bug数")
            ##                #labelCheckbox(ckId="checkbox-8" labelText="每人提交的Bug数")
            ##                #labelCheckbox(ckId="checkbox-9" labelText="每人解决的Bug数")
            ##                #labelCheckbox(ckId="checkbox-10"labelText="每人关闭的Bug数")
            ##                #labelCheckbox(ckId="checkbox-11"labelText="Bug严重程度统计")
            ##                #labelCheckbox(ckId="checkbox-12"labelText="Bug解决方案统计")
            ##                #labelCheckbox(ckId="checkbox-13"labelText="Bug状态统计")
            ##                #labelCheckbox(ckId="checkbox-14"labelText="Bug激活次数统计")
            ##                #labelCheckbox(ckId="checkbox-14"labelText="Bug类型统计")
            ##                #labelCheckbox(ckId="checkbox-14"labelText="指派给统计")
            #end
            #buttonRadiusDefault(btId="but1" btClass="but1" caption="全选")
            #buttonRadiusDefault(btId="but2" btClass="but2" caption="反选")
            #buttonRadiusDanger("buildChart" "buildChart" caption="生成报表")
        #end
    #end
    #@toggleRight("tableBoxessty")
        #@settoggleLeftTitle()报表#end
    <div id="chart"></div>
    ##        #include("project/task/reportFormDate.page")
    #end
#end


