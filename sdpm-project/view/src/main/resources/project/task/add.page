#import("/org/tinygroup/form/components/form.component")
#import("/org/tinygroup/bootstrapDate/components/bootstrapDate.component")
#import("/org/tinygroup/button/components/button_common.component")
#import("/org/tinygroup/button/components/button.component")
#import("/org/tinygroup/fold/components/fold.component")
#set(name="task")
#@div()
    #@tabWithInit("tab_demo" "optionsBox")
        #@div(divClass="dropdownBox")
            #include("/project/dropdownMenu.page")
        #end
        #@tabHead()
            #include("/project/protab.page")
        #end
    ##head end
    <br/>
    ##body end
    #end
#end
#@tinyForm(
    "addTaskForm" TINY_CONTEXT_PATH+adminPath+"/project/task/save" "post" {"class":"test","enctype":
    "multipart/form-data"})
<div class="pageleftpart">
    <div class="infoContent">
        <input type="hidden" name="taskOpenBy" value="${UserUtils.getUserId()}"/>
        <p class="titleName">建任务</p>
        #@elementItem()
            #@sdpmItem("所属项目")
                #tinyInput("hidden" "taskProject" currentProjectId)
                ${ProjectUtils.getProject(currentProjectId).projectName}
            #end
        #end
        #@elementItem()
            #@sdpmItem("所属模块")
                #@Tselect2F()
                    #@Tselect2Body("taskModule" copyTask?.taskModule {"class":
                        "input-text select2"})
                        <option value="">/</option>
                        #foreach(m : moduleList)
                            <option value=${m.moduleId}>${m.moduleName}</option>
                        #end
                    #end
                #end
            #end
        #end
        #@elementItem()
            #@sdpmItem("任务类型" "*")
                #@Tselect2F()
                    #@Tselect2Body(
                        "taskType" copyTask?.taskType {"class":"input-text select2","placeholder":"任务类型","datatype":"*",
                        "nullmsg":
                        "任务类型不能为空！"})
                        <option value="">/</option>
                        #foreach(item : getDict("taskType"))
                            <option value="${item?.value}">${item?.text}</option>
                        #end
                    #end
                #end
            #end
        #end
        #@elementItem()
            #@sdpmItem("指派给")
                #@Tselect2F()
                    #@Tselect2Body("taskAssignedTo" copyTask?.taskAssignedTo {"class":"input-text select2"})
                        <option value="">/</option>
                        #foreach(t : team)
                            <option value="${t?.teamUserId}">
                                ${t?.teamUserId==null?"":UserUtils.getUserById(t?.teamUserId)?.orgUserRealName}
                            </option>
                        #end
                    #end
                    #@Tselect2Fix()
                        <a href="${TINY_CONTEXT_PATH+adminPath}/org/user/form">增加</a>
                        <a href="${TINY_CONTEXT_PATH+adminPath}/org/user/list" class="r">全部</a>
                    #end
                #end
            #end
        #end
        #@elementItem()
            #@sdpmItem("相关需求")
                #@Tselect2F()
                    #@Tselect2Body("taskStory" story?.storyId==null?"":story.storyId {"class":
                        "input-text select2"})
                        <option value="">/</option>
                        #foreach(s : storyList)
                            <option value=${s?.storyId}>${s?.storyTitle}</option>
                        #end
                    #end
                    #@Tselect2Fix()
                        <a href="${TINY_CONTEXT_PATH+adminPath}/product/story/addstory">新增</a>
                        <a href="${TINY_CONTEXT_PATH+adminPath}/product/story/search" class="r">全部</a>
                    #end
                #end
            #end
        #end
        #@elementItem()
            #@sdpmItem("任务名称" "*")
                #@formControlDiv()
                    #tinyInput(
                        "text" "taskName" "" {"placeholder":"任务名称","datatype":"*","nullmsg":"任务名称不能为空！",
                        "class":"input-text"})
                #end
            #end
        #end
        #@elementItem()
            #@sdpmItem("任务描述")
                #@formControlDiv("col-8")
                ##                    #tinyInput(
                ##                        "text" "taskDesc" "任务描述"{"placeholder":"任务描述","datatype":"*4-16","id":
                ##                        "username",
                ##                        "class":"input-text"})
                    #@Teditor("taskDesc" "taskDesc" {"initialFrameHeight":"150","initialFrameWidth":"702"})${copyTask
                        ?.taskDesc}#end
                #end
            #end
        #end
        #@elementItem()
            #@sdpmItem("优先级")
                #@Tselect2F()
                    #@Tselect2Body(
                        "taskPri" copyTask?.taskPri {"class":"input-text","minimumResultsForSearch":"Infinity"})
                        <option value="">/</option>
                        #foreach(item : getDict("taskPri"))
                            <option value="${item?.value}">${item?.text}</option>
                        #end
                    #end
                ##填写任意内容，侦听需重新填加 A侦听已内置
                #end
            #end
        #end
        #@elementItem()
            #@sdpmItem("最初预计")
                #@formControlDiv()
                    <div class="input-group">
                        #tinyInput("text" "taskEstimate" copyTask?.taskEstimate {"placeholder":"最初预计","datatype":
                            "/^[0-9]+(.[0-9]{1,2})?$/",
                            "class":"","nullmsg":"请输入最初预计",
                            "aria-describedby":"basic-addon2"})
                        <span class="input-group-addon" id="basic-addon2">小时</span>
                    </div>
                #end
            #end
        #end
        #@elementItem()
            #@sdpmItem("抄送给")
                #@Tselect2F()
                    #@Tselect2Body("taskMailtoArray" copyTask?.taskMailTo {"class":"input-text select2","multiple":
                        "multiple"}) ##加上为多选项
                        #foreach(t : team)
                            <option value="${t.teamUserId}">
                                ${t?.teamUserId==null?"":UserUtils.getUserById(t?.teamUserId)?.orgUserRealName}
                            </option>
                        #end
                    #end
                ##填写任意内容，侦听需重新填加 A侦听已内置
                    #@Tselect2Fix()
                        <a href="${TINY_CONTEXT_PATH+adminPath}/org/user/form">增加</a>
                        <a href="${TINY_CONTEXT_PATH+adminPath}/org/user/list" class="r">全部</a>
                    #end
                #end
            #end
        #end
        #@elementItem()
            #@sdpmItem("附件")
                #fileWithInput("file")
            #end
        #end
    ##        #@elementItem()
    ##            #@sdpmItem("添加之后")
    ##                #@formControlDiv("skin-minimal col-9")
    ##                    #@tinyRadio("sex" "man" "man" {"nullmsg":"请选择性别！","datatype":"*"})继续为需求添加任务#end
    ##                    #@tinyRadio("sex" "women" "man")返回任务列表#end
    ##                    #@tinyRadio("sex" "secret" "man")返回需求列表#end
    ##                #end
    ##            #end
    ##        #end
        #@elementItem()
            <div class="col-12">
                <div class="col-2 text-r"><label>备注：</label></div>

                <div class="col-9">
                    #@Teditor("comment" "comment" {"initialFrameHeight":"150","initialFrameWidth":"702"})#end
                </div>
            </div>
        #end
        <br/>
    </div>
    #@elementItem()
        <div class="col-12">
            <div class="col-5">

            </div>
            <div class="col-1">
                <button style="float: left" type="submit" id="submit" class="commitBtn">保存</button>
            </div>
            <div class="col-1">
                #@aExtendButton("btn-sm backBtn" "javascript:history.go(-1)")取消#end
            </div>
            <div class="col-5"></div>
        </div>
    #end
    <br>
</div>
#end


<script type="text/javascript">
    $(function () {
        $("form").Validform({});
    });
</script>