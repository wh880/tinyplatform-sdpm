#import("/org/tinygroup/button/components/button_common.component")
#import("/org/tinygroup/button/components/button.component")
#!set(activeTitle="测试管理",activeMenuId=currentPageId)
<style>
    .select_boxes{margin-top:0}
    .tableBoxes tbody tr{height:30px;}
    .tableBoxes tbody tr td{padding:10px 7px;vertical-align:middle}
</style>

#set(name="qualityCases")
#@div()
    #@tabWithInit("tab_demo" "optionsBox")
        #@div(divClass="dropdownBox")
            #include("/testManagement/page/dropdownMenu.page")
        #end
        #@tabHead()
            #include("/testManagement/page/Tab.page")
        #end

        #@tabBodyCol("ptop-5")
##operationbar start1

#end
#end
    #@tinyForm("thisform" TINY_CONTEXT_PATH+adminPath+"/quality/testCase/save" "post" {"class":"","enctype":"multipart/form-data"})
	<div style="width:100%">
    	<div class="infoContent">
    		<p class="titleName">建用例</p>
        #@elementItem()
            #@colLabel()产品模块：#end
            #@formControlDiv("col-8")
                #@div(divClass="col-5")
					 #@Tselect2F()
	                   		 #@Tselect2Body("productId" testCase?.productId {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
	                       
	                    	#end    
	                    	<script>
							
		                        ajaxRead("${sid}", "productId", "productId", "productName", "/product/productList",${testCase?.productId?:0});
								
								 $("#${sid}").on("change", function () {
		                            var pId = $("#${sid}  option:selected").val();
		                            if(pId>0){
                                        ajaxRead("${sid}", "moduleId", "moduleId", "moduleName", "/quality/bug/ajax/module?moduleRoot=" + pId,${testCase?.moduleId?:0},"module");
                                    }
		                        });
		                    </script>
                         #@Tselect2Fix()
                             #set(m=menuManager.getMenu("newproduct"))
                             #if(m)
                                 <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                             #end
                             #set(m=menuManager.getMenu("allproduct"))
                             #if(m)
                                 <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                             #end
                	    #end
                    #end
                    #end
					#@div(divClass="col-3")
					 #@Tselect2F()
	                   		 #@Tselect2Body("moduleId" testCase?.moduleId {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
	                    	#end
                         <script type="text/javascript">
                             $("#${sid}").on("change",function(){
                                 var pId = $("select[name=productId] option:selected").val();
                                 var mId = $("#${sid}  option:selected").val();
                                 if(pId>0&&mId>0){
                                     ajaxRead("${sid}","storyId","storyId","storyTitle","/quality/testCase/ajax/story?productId="+pId+"&moduleId="+mId,${(testCase?.storyId?:storyId)?:0});
                                 }
                             });
                         </script>
                	  #end
					#end
				#end

        #end
        #@elementItem()
            #@colLabel()<span class="c-red">*</span>用例类型：#end
            #@formControlDiv("col-8")
            	#@div(divClass="col-5")
                     #@Tselect2F()
	                   		#@Tselect2Body("caseType" testCase?.caseType {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
	                   		 	#foreach(caseType:getDict("caseType"))
	                   		 		<option value="${caseType.value}">${caseType.text}</option>
	                   		 	#end
	                    	#end              
                	  #end
                #end
                    #@validateDiv("col-2")#end
            #end
            #@validateDiv("col-2")#end
        #end
        #@elementItem()
            #@colLabel()<span class="c-red">*</span>试用阶段：#end
            #@formControlDiv("col-8")
               #@div(divClass="col-5")
					#@Tselect2F()
	                   		 #@Tselect2Body("caseStage" testCase?.caseStage {"class":"input-text select2","multiple":"multiple"}) ##,"multiple":"multiple"加上为多选项
		                        #foreach(stage:getDict("caseStage"))
	                   		 		<option value="${stage.value}">${stage.text}</option>
	                   		 	#end
	                    	#end                
                 	#end
                #end
            #end
            #@validateDiv("col-2")#end
        #end

        #@elementItem()
            #@colLabel()<span class="c-red">*</span>优先级：#end
            #@formControlDiv("col-8")
                #@div(divClass="col-5")
					#@Tselect2F()
	                   		 #@Tselect2Body("priority" testCase?.priority {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
		                        #foreach(pri:getDict("casePriority"))
	                   		 		<option value="${pri.value}">${pri.text}</option>
	                   		 	#end
	                    	#end                
             		#end
                #end
            #end
            #@validateDiv("col-2")#end
        #end

        #@elementItem()
            #@colLabel()<span class="c-red">*</span>相关需求：#end
            #@formControlDiv("col-8")
					#@div(divClass="col-5")
							 #@Tselect2F()
	                   		 #@Tselect2Body("storyId" testCase?.storyId {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
	                    	#end
                                 #@Tselect2Fix()
                                     #@hasMenu("product-demand-add")
                                         <a href="${TINY_CONTEXT_PATH+adminPath}/product/story/addstory"
                                            class="r ">增加</a>
                                     #end
                                     #@hasMenu("product-demand")
                                         <a href="${TINY_CONTEXT_PATH+adminPath}/product/story?choose=1">全部</a>
                                     #end
                                 #end
                			#end
					#end
			#end
        #end
        #@elementItem()
            #@colLabel()<span class="c-red">*</span>用例标题：#end
            #@formControlDiv("col-8")
            #@div(divClass="col-5")
                #tinyInput("text" "caseTitle" testCase?.caseTitle {"datatype":"*10-500","id":"版本","class":"input-text"})
            #end
            #end
            #@validateDiv("col-2")#end
        #end
        #@elementItem()
            #@colLabel()前置条件：#end
            #@formControlDiv("col-8")
                #@tinyTextarea("casePrecondition" {"placeholder":"说点什么...最少输入10个字符"})${testCase?.casePrecondition}#end
            #end
            #@validateDiv("col-2")#end
        #end
        ##暂留、、、、、、、、、、、、、、、、、
        #@elementItem()
            #@colLabel()用例步骤：#end
          	 	<div class="col-8">
	      		   #include("/testManagement/page/caseStepAdd.page") 
	            </div>
            #@validateDiv("col-2")#end
        #end
        #@elementItem()
            #@colLabel()关键词：#end
            #@formControlDiv("col-8")
            	#@div(divClass="col-5")
                	#tinyInput("text" "caseKeywords" testCase?.caseKeywords {"datatype":"","id":"","class":"input-text"})
            	#end
            #end
            #@validateDiv("col-2")#end
        #end
        #@elementItem()
            <div class="col-12">
                <div class="col-2 text-r"><label>附件：</label></div>
                <div class="col-7">
                    #mulUploadFile()
                </div>
            </div>
        #end
       #@elementItem()
        <div class="col-12">
            <div class="col-5">

            </div>
            <div class="col-1">
                <button style="float: left" type="submit" id="submit2" class="commitBtn">保存</button>
            </div>
            <div class="col-1">
#*            <a href="${TINY_CONTEXT_PATH+adminPath}/testManagement/page/cases.page">
                <button style="float: left" type="button" id="back" class="backBtn">返回</button></a>*#
                #@aExtendButton("btn-sm backBtn" "javascript:history.go(-1)")返回#end
            </div>
            <div class="col-5"></div>
        </div>
    #end
    <br>
    #end
    </div>
   </div>
<script type="text/javascript">
    $("select.select2").select2();
</script>


#end
