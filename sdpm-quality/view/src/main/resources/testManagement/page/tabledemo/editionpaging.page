
#@div(divClass="infoContent")
<p class="titleName">基本信息</p>
##该样式在comm.css样式中自定义
    #@table("adjustTable")
        #@thead()
        #end
        #@tbody()
            #@tr()
                #@th()所属产品#end
                #@td()
                    #@TzTreeSelect(
                        "productId" bug?.productId {"class":"input-text","datatype":"*","nullmsg":"所属产品不能为空！",
                        "data-URL":call("link",adminPath+"/productLine/userProductTree")})
                    <script>
                        $(function(){
                            var mUrl = $("#modelA").attr("href");
                            $("#${sid}").on("setValue",function(o,treeNode){
                                var pId = treeNode.id;
                                var pjId = $("select[name=projectId]").val("");
                                if(pId>0){
                                    ajaxRead("${sid}","moduleId","moduleId","moduleName","/quality/bug/ajax/module?moduleRoot="+pId,${bug?.moduleId?:0},"module");
                                    ajaxRead("${sid}","projectId","projectId","projectName","/quality/bug/ajax/project?productId="+pId,${bug?.projectId?:0});
                                    ajaxRead("${sid}", "planId", "planId", "planName", "/quality/bug/ajax/plan?deleted=0&productId=" + pId, ${bug?.planId?: 0},"plan");
                                    $("#modelA").attr("href",mUrl+pId);
                                }
                            });
                        });
                    </script>
                    <span>
                        #set(m=menuManager.getMenu("newproduct"))
                        #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                        #end
                        #set(m=menuManager.getMenu("allproduct"))
                        #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                        #end
                    </span>
                    #end

                #end
                #@tr()
                    #@th()所属模块#end
                    #@td()
                        #@Tselect2F()
                            #@Tselect2Body("moduleId" bug?.moduleId?:0 {"class":
                                "input-text select2"}) ##,"multiple":"multiple"加上为多选项
                            #end
                        <script type="text/javascript">
                            $(function () {
                                $("#${sid}").on("change", function () {
                                    var mId = $("#${sid}  option:selected").val();
                                    var pId = $("input[name=productId]").val();
                                    if (mId >= 0) {
                                        ajaxRead("${sid}", "storyId", "storyId", "storyTitle", "/quality/bug/ajax/story?productId=" + pId + "&moduleId=" + mId, ${bug?.storyId?: 0});
                                    }
                                })
                            })
                        </script>
                            #@Tselect2Fix()#@aModal("#myModal" "" "500" "300" "btn-class" adminPath+"/product/addModule?pId=" "modelA")
                            增加#end
                            #end
                        #end

                        #@tr()
                            #@th()所属计划#end
                            #@td()
                                #@Tselect2F()
                                    #@Tselect2Body("planId" bug?.planId {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项

                                    #end
                                    #@Tselect2Fix()
                                        #set(m=menuManager.getMenu("product-plan-add"))
                                        #if(m)
                                        <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                                        #end
                                        #set(m=menuManager.getMenu("product-plan"))
                                        #if(m)
                                        <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                                        #end
                                    #end
                                #end
                            #end
                        #end     #end
                #end
                #@tr()
                    #@th()Bug类型#end
                    #@td()
                        #@Tselect2F()
                            #@Tselect2Body(
                                "bugType" bug?.bugType {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
                                #for(type : getDict("bugType"))
                            <option value="${type.value}">${type.text}</option>
                            #end
                        #end
                    ##	                    	#@Tselect2Fix()
                    ##	                    		<a href="${TINY_CONTEXT_PATH+adminPath}/testManagement/page/proposeBug.page" class="r">增加</a>
                    ##	                    		<a href="${TINY_CONTEXT_PATH+adminPath}/testManagement/page/Bug.page">全部</a>
                    ##	                    	#end
                    #end

                #end
            #end
            #@tr()
                #@th()优先级#end
                #@td()
                    #@Tselect2F()
                        #@Tselect2Body(
                            "priority" bug?.priority {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
                            #for(pri : getDict("bugPriority"))
                            #@tinyOptionItem(pri.value)${pri.text}#end
                        #end
                    #end
                #end
            #end
        #end
        #@tr()
            #@th()Bug状态#end
            #@td()
                #@Tselect2F()
                    #@Tselect2Body(
                        "bugStatus" bug?.bugStatus {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
                        #for(status : getDict("bugStatus"))
                        #@tinyOptionItem(status.value)${status.text}#end
                    #end
                #end
            #end
        #end
    #end
    #@tr()
        #@th()指派给#end
        #@td()
            #@Tselect2F()
                #@Tselect2Body(
                    "bugAssignedTo" bug?.bugAssignedTo?:0 {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
                    #foreach(user : userList)
                    <option value="${user?.orgUserId}">${user?.orgUserRealName}</option>
                    #end
                #end
                #@Tselect2Fix()
                    #set(m=menuManager.getMenu("organizationAddUser"))
                    #if(m)
                    <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                    #end
                    #set(m=menuManager.getMenu("organizationUser"))
                    #if(m)
                    <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                    #end
                #end
            #end
            #@validateDiv("col-2")#end
        #end
    #end
    #@tr()
        #@th()操作系统#end
        #@td()
            #@Tselect2F()
                #@Tselect2Body("operatingSystem" bug?.operatingSystem {"class":
                    "input-text select2"}) ##,"multiple":"multiple"加上为多选项
                    #for(os : getDict("bugOS"))
                    #@tinyOptionItem(os.value)${os.text}#end
                #end
            #end
        #end
    #end
#end
#@tr()
    #@th()浏览器#end
    #@td()
        #@Tselect2F()
            #@Tselect2Body("browser" bug?.browser {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
                #for(bro : getDict("bugBrowser"))
                #@tinyOptionItem(bro.value)${bro.text}#end
            #end
        #end
    #end
#end
#end
#@tr()
    #@th()关键词#end
    #@td()
        #tinyInput("text" "bugKeywords" bug?.bugKeywords {"datatype":"","id":"版本","class":"input-text"})
    #end
#end
#@tr()
    #@th()抄送给#end
    #@td()
        #@Tselect2F()
            #@Tselect2Body("bugMailto" bug?.bugMailto {"class":"input-text select2","multiple":
                "multiple"}) ##,"multiple":"multiple"加上为多选项
                #foreach(user : userList)
                <option value="${user?.orgUserId}">${user?.orgUserRealName}</option>
                #end
            #end
            #@Tselect2Fix()
                #set(m=menuManager.getMenu("organizationAddUser"))
                #if(m)
                <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                #end
                #set(m=menuManager.getMenu("organizationUser"))
                #if(m)
                <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                #end
            #end
        #end
    #end
#end
#end
#end
#end
#end
#@div(divClass="infoContent")
<p class="titleName">项目/需求/任务</p>
##该样式在comm.css样式中自定义
    #@table("adjustTable")
        #@thead()
        #end
        #@tbody()
            #@tr()
                #@th()所属项目#end
                #@td()
                    #@Tselect2F()
                    <script type="text/javascript">
                        $("#${sid}").on("change", function () {
                            var pjId = $("#${sid}  option:selected").val();
                            var pId = $("input[name=productId]").val();
                            if (pjId > 0) {
                                ajaxRead("${sid}", "taskId", "taskId", "taskName", "/quality/bug/ajax/task?taskProject=" + pjId, ${bug?.taskId ?: 0});
                                if(pId>0){
                                    ajaxRead("${sid}", "bugOpenedBuild", "buildId", "buildName", "/quality/bug/ajax/build?buildProduct=" + pId+"&buildProject="+pjId, ${bug?.bugOpenedBuild},"build");
                                    ajaxRead("${sid}", "bugResolvedBuild", "buildId", "buildName", "/quality/bug/ajax/build?buildProduct=" + pId+"&buildProject="+pjId, ${bug?.bugResolvedBuild},"build");
                                }
                            }
                        })
                    </script>
                        #@Tselect2Body(
                            "projectId" bug?.projectId?:(projectList.size()>0?projectList.get(0).projectId:0) {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
                            #foreach(project : ProjectUtils.getUserProjectList())
                            <option value="${project?.projectId}">${project?.projectName}</option>
                            #end
                        #end

                        #@Tselect2Fix()
                            #set(m=menuManager.getMenu("project-op-add"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                            #end
                            #set(m=menuManager.getMenu("project-op-all"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                            #end
                        #end
                    #end
                #end
            #end
            #@tr()
                #@th()相关需求#end
                #@td()
                    #@Tselect2F()
                        #@Tselect2Body("storyId" "" {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项

                        #end
                        #@Tselect2Fix()
                            #set(m=menuManager.getMenu("product-demand-add"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                            #end
                            #set(m=menuManager.getMenu("product-demand"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                            #end
                        #end
                    #end
                #end
            #end
            #@tr()
                #@th()相关任务#end
                #@td()
                    #@Tselect2F()
                        #@Tselect2Body(
                            "taskId" bug?.taskId {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项

                        #end
                        #@Tselect2Fix()
                            #set(m=menuManager.getMenu("pro-task-proposeversion"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                            #end
                            #set(m=menuManager.getMenu("task"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                            #end
                        #end
                    #end
                #end
            #end
        #end
    #end
#end

#@div(divClass="infoContent")
<p class="titleName">BUG的一生</p>
##该样式在comm.css样式中自定义
    #@table("adjustTable")
        #@thead()
        #end
        #@tbody()
            #@tr()
                #@th()由谁创建#end
                #@td()
                    #@Tselect2F()
                        #@Tselect2Body("bugOpenedBy" bug?.bugOpenedBy?:0 {"class":
                            "input-text select2"}) ##,"multiple":"multiple"加上为多选项
                            #foreach(user : userList)
                            <option value="${user?.orgUserId}">${user?.orgUserRealName}</option>
                            #end
                        #end
                        #@Tselect2Fix()
                            #set(m=menuManager.getMenu("organizationAddUser"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                            #end
                            #set(m=menuManager.getMenu("organizationUser"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                            #end
                        #end
                    #end
                #end
            #end
            #@tr()
                #@th()<span class="c-red">*</span>影响版本#end
                #@td()
                    #@Tselect2F()
                        #@Tselect2Body("bugOpenedBuild" bug?.bugOpenedBuild {"class":"input-text select2","multiple":
                            "multiple"}) ##,"multiple":"multiple"加上为多选项
                        #end
                        #@Tselect2Fix()
                            #set(m=menuManager.getMenu("pro-version-add"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                            #end
                            #set(m=menuManager.getMenu("version"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                            #end
                        #end
                    #end
                #end
            #end
            #@tr()
                #@th()解决者#end
                #@td()
                    #@Tselect2F()
                        #@Tselect2Body("bugResolvedBy" bug?.bugResolvedBy?:0 {"class":
                            "input-text select2"}) ##,"multiple":"multiple"加上为多选项
                        <option value=""></option>
                            #foreach(user : userList)

                            <option value="${user?.orgUserId}">${user?.orgUserRealName}</option>
                            #end
                        #end

                        #@Tselect2Fix()
                            #set(m=menuManager.getMenu("organizationAddUser"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                            #end
                            #set(m=menuManager.getMenu("organizationUser"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                            #end
                        #end
                    #end
                    #@validateDiv("col-2")#end
                #end
            #end
            #@tr()
                #@th()解决日期#end
                #@td()
                    ${bug?.bugResolvedDate?formatDate(bug?.bugResolvedDate,"yyyy-MM-dd hh-mm-ss"):""}
                #end
            #end
            #@tr()
                #@th()解决版本#end
                #@td()
                    #@Tselect2F()
                        #@Tselect2Body("bugResolvedBuild" bug?.bugResolvedBuild?:0 {"class":
                            "input-text select2"}) ##,"multiple":"multiple"加上为多选项


                        #end
                        #@Tselect2Fix()
                            #set(m=menuManager.getMenu("pro-version-add"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                            #end
                            #set(m=menuManager.getMenu("version"))
                            #if(m)
                            <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                            #end
                        #end
                    #end
                    #@validateDiv("col-2")#end
                #end
            #end
            #@tr()
                #@th()解决方案#end
                #@td()
                    #@Tselect2F()
                        #@Tselect2Body("bugResolution" bug?.bugResolution {"class":
                            "input-text select2"}) ##,"multiple":"multiple"加上为多选项
                        <option value=""></option>
                            #for(re : getDict("bugResolution"))
                            #@tinyOptionItem(re.value)${re.text}#end
                        #end
                    #end
                #end
            #end
        #end
        #@tr()
            #@th()由谁关闭#end
            #@td()
                #@Tselect2F()
                    #@Tselect2Body(
                        "bugClosedBy" bug?.bugClosedBy {"class":"input-text select2"}) ##,"multiple":"multiple"加上为多选项
                    <option value=""></option>
                        #foreach(user : userList)

                        <option value="${user?.orgUserId}">${user?.orgUserRealName}</option>
                        #end
                    #end

                    #@Tselect2Fix()
                        #set(m=menuManager.getMenu("organizationAddUser"))
                        #if(m)
                        <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}" class="r">增加</a>
                        #end
                        #set(m=menuManager.getMenu("organizationUser"))
                        #if(m)
                        <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}">全部</a>
                        #end
                    #end
                #end
                #@validateDiv("col-2")#end
            #end
        #end
        #@tr()
            #@th()重复ID#end
            #@td()
                #tinyInput(
                    "text" "bugDuplicateBug" bug?.bugDuplicateBug {"datatype":"","id":"抄送给","class":"input-text"})
            #end
        #end
        #@tr()
            #@th()关闭日期#end
            #@td()
                ${bug?.bugClosedDate?formatDate(bug?.bugClosedDate,"yyyy-MM-dd hh-mm-ss"):""}
            #end
        #end
    #end
#end
#end
#@div(divClass="infoContent")
<p class="titleName">其他相关</p>
##该样式在comm.css样式中自定义
    #@table("adjustTable")
        #@thead()
        #end
        #@tbody()
            #@tr()
                #@th()相关Bug#end
                #@td()#tinyInput("text" "linkBug" bug?.linkBug {"datatype":"","id":"抄送给","class":"input-text"})
                #end
            #end
            #@tr()
                #@th()相关用例#end
                #@td()#tinyInput("text" "linkCase" bug?.linkCase {"datatype":"","id":"抄送给","class":"input-text"})
                #end
            #end
        #end
    #end
#end


<script>
    $(function(){
        $('select.select2').select2();
    })

</script>
