

<table class="table tinytable table table-hover" id="group-Table">
    #@thead()
        #@tr()
            #@tinyTh()#end
            #@tinyTh()ID#end
            #@tinyTh()P#end
            #@tinyTh()用例标题#end
            #@tinyTh()类型#end
            #@tinyTh()创建#end
            #@tinyTh()执行人#end
            #@tinyTh()执行时间#end
            #@tinyTh()结果#end
            #@tinyTh()状态#end
            #@tinyTh()操作#end
        #end
    #end
    #@tbody()
        #foreach(story : storyMap)
            <tr class="show-group" data-tr="data-g-${story?.key}">
                <td>
                    <span class="glyphicon glyphicon-chevron-right">
                        ${story?.value?.storyTitle}
                    </span>
                </td>
                <td colspan="11"></td>
            </tr>
            #foreach(c : casesMap.get(story?.key))
                <tr class="data-g-${story?.key} hide">
                    #@td()#end
                    #@td()<a href="${TINY_CONTEXT_PATH+adminPath}/quality/testCase/case/viewInfo?id=${c?.caseId}">${c?.no}</a>#end
                    #@td()${getDict("casePriority",c?.priority)}#end
                    #@td()<a href="${TINY_CONTEXT_PATH+adminPath}/quality/testCase/case/viewInfo?id=${c?.caseId}">${c?.caseTitle}</a>#end
                    #@td()${getDict("caseType",c?.caseType)}#end
                    #@td()${c?.caseOpenedBy?UserUtils.getUserById(c?.caseOpenedBy)?.orgUserRealName:""}#end
                    #@td()${c?.caseLastRunner?UserUtils.getUserById(c?.caseLastRunner)?.orgUserRealName:""}#end
                    #@td()${c?.caseLastRunDate?formatDate(c?.caseLastRunDate,'yyyy-MM-dd HH:mm:ss'):""}#end
                    #@td()${getDict("caseResult",c?.caseLastRunResult)}#end
                    #@td()${getDict("caseStatus",c?.caseStatus)}#end
                    #@td()
                            #foreach(m:menuManager.getScopeMenus("testcase-op"))

                                #if(m.id=="teditioncase"||m.id=="tproposecase")
                                <a href="${TINY_CONTEXT_PATH+adminPath}${m.href}?caseId=${c?.caseId}"
                                   title="${m.name}">#buttonIcon(iconClass=m.icon)</a>
                                #else
                                    #if(m.id=="texecution"||m.id=="tresult")
                                        #iconOperations("#myModal" m.icon m.name "865" "400" adminPath + m.href+"?caseId="+c?.caseId+"&caseVersion="+c?.caseVersion "ml-1")
                                    #else
                                        #@tinyTableItemRemove(TINY_CONTEXT_PATH +adminPath+m.href  c?.caseId)<i class="${m.icon}"></i>
                                        #end
                                    #end
                                #end
                            #end
                        #end
                </tr>
            #end
        #end
    #end
</table>

<script>
    $(function () {
        $("#group-Table").off("click", ">tbody>tr>td").on("click", ".show-group", function (e) {
            $(this).find(".glyphicon").toggleClass("glyphicon-chevron-right glyphicon-chevron-down");
            $("#group-Table>tbody").children("tr." + $(this).attr("data-tr")).toggle();
        });
    })
</script>